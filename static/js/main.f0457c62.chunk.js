(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,n){e.exports=n(20)},15:function(e,t,n){},16:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"calcStandings",function(){return j}),n.d(r,"modifiedMedian",function(){return k}),n.d(r,"playerColorBalance",function(){return R}),n.d(r,"playerOppScoreCum",function(){return w}),n.d(r,"playerScore",function(){return N}),n.d(r,"playerScoreCum",function(){return O}),n.d(r,"playerScoreList",function(){return b}),n.d(r,"solkoff",function(){return B});var a=n(0),l=n.n(a),i=n(5),u=n.n(i),c=(n(15),n(1)),o=(n(16),n(3)),s=n(9),m=n.n(s);function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1200,r={firstName:"",lastName:"",rating:0,dummy:!1,Ne:0,eloRank:function(e){var t=e.getMatchesByPlayer(r).length,n=800/(r.Ne+t);return new m.a(n)}};return"object"===typeof e?Object.assign(r,e):(r.firstName=e,r.lastName=t,r.rating=n),r}var d=Object.freeze(f({firstName:"Dummy",dummy:!0,rating:0}));function y(e){var t=e.players[0].eloRank(e.tourney),n=e.players[1].eloRank(e.tourney),r=[t.getExpected(e.origRating[0],e.origRating[1]),n.getExpected(e.origRating[1],e.origRating[0])];return e.newRating=[t.updateRating(r[0],e.result[0],e.origRating[0]),n.updateRating(r[1],e.result[1],e.origRating[1])],e.newRating=e.newRating.map(function(e){return e<100?100:e}),e.players[0].rating=e.newRating[0],e.players[1].rating=e.newRating[1],e}var g=Object.freeze(function(e,t,n){var r={round:e,tourney:e.tourney,warnings:null,players:[t,n],result:[0,0],origRating:[t.rating,n.rating],newRating:[t.rating,n.rating],reverse:function(){return r.players.reverse(),r.result.reverse(),r.origRating.reverse(),r.newRating.reverse(),r},blackWon:function(){return r.result=[0,1],y(r),r},whiteWon:function(){return r.result=[1,0],y(r),r},draw:function(){return r.result=[.5,.5],y(r),r},resetResult:function(){return r.result=[0,0],r.newRating=Object(o.a)(r.origRating),r.players[0].rating=r.newRating[0],r.players[1].rating=r.newRating[1],r},isComplete:function(){return r.result[0]+r.result[1]!==0},isBye:function(){return r.players.includes(d)},getColorInfo:function(e){return{player:r.players[e],result:r.result[e],origRating:r.origRating[e],newRating:r.newRating[e]}},getPlayerColor:function(e){return r.players.indexOf(e)},getPlayerInfo:function(e){return r.getColorInfo(r.getPlayerColor(e))},getWhite:function(){return r.getColorInfo(0)},getBlack:function(){return r.getColorInfo(1)}};return r.players[0]===d?r.result=[0,1]:r.players[1]===d&&(r.result=[1,0]),r});var p=Object.freeze(function(e){var t={tourney:e,all:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],inactive:[],getActive:function(){return t.all.filter(function(e){return!t.inactive.includes(e)})},addPlayer:function(e){return t.all.push(e),t},addPlayers:function(e){return t.all=t.all.concat(e),t},deactivatePlayer:function(e){return t.inactive.push(e),t},activatePlayer:function(e){return t.inactive.splice(t.inactive.indexOf(e),1),t},removePlayer:function(e){return t.tourney.getMatchesByPlayer(e).length>0?null:(delete t.all[t.all.indexOf(e)],t)}};return t}),h=n(4),v=n(6);console.log(r),v.tieBreak.forEach(function(e){e.func=r[e.funcName]});var E=Object.freeze(v);function b(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.getMatchesByPlayer(t,n).map(function(e){return e.result[e.players.indexOf(t)]})}function N(e,t){var n=0,r=b(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);return r.length>0&&(n=r.reduce(function(e,t){return e+t})),n}function O(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=0,a=[];(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.getMatchesByPlayer(t,n).filter(function(e){return!e.isBye()}).map(function(e){return e.result[e.players.indexOf(t)]})})(e,t,n).forEach(function(e){r+=e,a.push(r)});var l=0;return 0!==a.length&&(l=a.reduce(function(e,t){return e+t})),l}function R(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=0;return e.getMatchesByPlayer(t,n).filter(function(e){return!e.isBye()}).forEach(function(e){e.players[0]===t?r+=1:e.players[1]===t&&(r+=-1)}),r}function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.getPlayersByOpponent(t,n).filter(function(e){return e!==d}).map(function(t){return N(e,t,n)});a.sort(),r||(a.pop(),a.shift());var l=0;return a.length>0&&(l=a.reduce(function(e,t){return e+t})),l}function B(e,t){return k(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,!0)}function w(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.getPlayersByOpponent(t,n).filter(function(e){return e!==d}).map(function(t){return O(e,t,n)}),a=0;return 0!==r.length&&(a=r.reduce(function(e,t){return e+t})),a}function j(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=E.tieBreak.filter(function(e){return e.active}),r=e.roster.all.map(function(r){var a={player:r,score:N(e,r,t)};return n.forEach(function(n){a[n.func.name]=n.func(e,r,t)}),a}),a=Object(h.firstBy)(function(e){return e.score},-1);n.forEach(function(e){a=a.thenBy(function(t){return t[e.func.name]},-1)}),r.sort(a);var l=[],i=0;return r.forEach(function(e,t,n){0!==t&&(function(e,t){var n=Object.getOwnPropertyNames(e),r=!0;return n.forEach(function(n){"player"!==n&&e[n]!==t[n]&&(r=!1)}),r}(e,n[t-1])||(i+=1));l[i]||(l[i]=[]),l[i].push(e)}),l}var C=n(2);function P(e,t,n,r){var a,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[],i=e.prevRound.playerColor(n),u=r.filter(function(e){return!l.includes(e)}).filter(function(e){return e!==n}).filter(function(e){return!Object(C.flatten)(t.map(function(e){return e.players})).includes(e)}),c=r.filter(function(t){return i!==e.prevRound.playerColor(t)}),o=u.filter(function(e){return c.includes(e)})[0]||u[0];return o&&(a=g(e,n,o),R(e.tourney,n)>R(e.tourney,o)&&a.reverse()),[o,a]}var M=Object.freeze(function(e,t,n,r){var a={id:t,tourney:e,roster:r,prevRound:n,playerTree:{},matches:[],hasDummy:!1,isComplete:function(){return!a.matches.map(function(e){return e.isComplete()}).includes(!1)},getMatchByPlayer:function(e){var t=null;return a.matches.forEach(function(n){n.players.includes(e)&&(t=n)}),t},playerColor:function(e){var t=-1;return a.matches.forEach(function(n){n.players.includes(e)&&(t=n.players.indexOf(e))}),t},addPlayer:function(e){return a.players.push(e),a}};return a.matches=function(e){var t=[],n=e.tourney;function r(e){var t=Object.keys(e);return t.sort(function(e,t){return Number(t)-Number(e)}),t}return e.roster.forEach(function(t){var r=N(n,t,e.id);void 0===e.playerTree[r]&&(e.playerTree[r]=[]),e.playerTree[r].push(t)}),r(e.playerTree).forEach(function(t,r,a){var l=e.playerTree[t];if(l.sort(Object(h.firstBy)(function(t){return N(n,t,e.id)},-1).thenBy(function(e){return e.rating},-1)),l.length%2!==0)if(e.roster.length%2===0||e.hasDummy){var i=l[l.length-1];l.splice(l.length-1,1);var u=a[r+1];void 0===e.playerTree[u]&&(e.playerTree[u]=[]),e.playerTree[u].push(i)}else l.push(d),e.hasDummy=!0;0===l.length?delete e.playerTree[t]:e.playerTree[t]=Object(C.chain)(l).chunk(l.length/2).value()}),r(e.playerTree).forEach(function(r){var a=e.playerTree[r][0],l=e.playerTree[r][1];if(void 0===e.prevRound)Object(C.zip)(a,l).forEach(function(n){return t.push(g.apply(void 0,[e].concat(Object(o.a)(n))))});else{var i=a.map(function(e){return[].concat(l).concat(a).filter(function(t){return n.getPlayersByOpponent(t).includes(e)})});a.forEach(function(r){var u,o,s=i[a.indexOf(r)],m=Object(C.flatten)(i.slice(a.indexOf(r))),f=P(e,t,r,l.filter(function(e){return m.includes(e)}),s),d=Object(c.a)(f,2);if(u=d[0],o=d[1],!u){var y=P(e,t,r,l,s),g=Object(c.a)(y,2);u=g[0],o=g[1]}if(!u){var p=P(e,t,r,l,[]),h=Object(c.a)(p,2);u=h[0],o=h[1]}if(s.includes(u)){var v=!1;a.filter(function(e){return e!==r}).forEach(function(e){if(!v){var n=t.filter(function(t){return t.players.includes(e)})[0];if(n){var l=n.players.filter(function(t){return t!==e})[0],c=i[a.indexOf(e)];s.includes(l)||c.includes(u)||(o.players=[r,l],n.players=[e,u],v=!0)}}})}n.getPlayersByOpponent(r).includes(u)&&(o.warnings=r.firstName+" has played "+u.firstName+" previously."),t.push(o)})}}),t}(a),a});var S=Object.freeze(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n={name:e,roundList:[],byeValue:1,isNewRoundReady:function(){return n.roundList.length>0?Object(C.last)(n.roundList).isComplete():n.roster.all.length>0},getMatchesByPlayer:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===t&&(t=n.roundList.length);var r=[];return Object(C.times)(t+1,function(t){void 0!==n.roundList[t]&&n.roundList[t].matches.forEach(function(t){-1!==t.players.indexOf(e)&&r.push(t)})}),r},getPlayersByOpponent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=[];return n.getMatchesByPlayer(e,t).forEach(function(t){r=r.concat(t.players.filter(function(t){return t!==e}))}),r},getNumOfRounds:function(){var e=Math.ceil(Math.log2(n.roster.getActive().length));return e===-1/0&&(e=0),e},newRound:function(){if(!n.isNewRoundReady())return!1;var e=M(n,n.roundList.length,Object(C.last)(n.roundList),n.roster.getActive());return n.roundList.push(e),e}};return n.roster=p(n,t),n}),x=Object.freeze([{firstName:"Matthew",lastName:"A",rating:800},{firstName:"Mark",lastName:"B",rating:850},{firstName:"Luke",lastname:"C",rating:900},{firstName:"John",lastname:"D",rating:950},{firstName:"Simon",lastname:"E",rating:1e3},{firstName:"Andrew",lastname:"F",rating:1050},{firstName:"James",lastname:"G",rating:1100},{firstName:"Philip",lastname:"H",rating:1150},{firstName:"Bartholomew",lastname:"I",rating:1200},{firstName:"Thomas",lastname:"J",rating:1250},{firstName:"Catherine",lastname:"K",rating:1300},{firstName:"Clare",lastname:"L",rating:1350},{firstName:"Judas",lastname:"M",rating:1400},{firstName:"Matthias",lastname:"N",rating:1450},{firstName:"Paul",lastname:"O",rating:1500},{firstName:"Mary",lastname:"P",rating:1600},{firstName:"Theresa",lastname:"Q",rating:1650},{firstName:"Megan",lastname:"R",rating:1700},{firstName:"Elizabeth",lastname:"S",rating:1750}]);function W(e){var t=e.tourney,n=Object(a.useState)(t.roster.all),r=Object(c.a)(n,2),i=r[0],u=r[1],o=Object(a.useState)(!1),s=Object(c.a)(o,2),m=s[0],d=s[1],y={firstName:"",lastName:"",rating:1200},g=function(e){y[e.target.name]=e.target.value},p="";return i.length>0&&(p=l.a.createElement("table",null,l.a.createElement("caption",null,"Roster"),l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"First name"),l.a.createElement("th",null,"Rating"),l.a.createElement("th",null,"Rounds played"),l.a.createElement("th",null))),l.a.createElement("tbody",null,i.map(function(e,n){return l.a.createElement("tr",{key:n,className:t.roster.inactive.includes(e)?"inactive":"active"},l.a.createElement("td",{className:"table__player"},e.firstName),l.a.createElement("td",{className:"table__number"},e.rating),l.a.createElement("td",{className:"table__number"},t.getMatchesByPlayer(e).length),l.a.createElement("td",null,t.roster.inactive.includes(e)?l.a.createElement("button",{onClick:function(){return function(e){t.roster.activatePlayer(e),u([].concat(t.roster.all))}(e)}},"Activate"):l.a.createElement("button",{onClick:function(){return function(e){t.roster.removePlayer(e)||t.roster.deactivatePlayer(e),u([].concat(t.roster.all))}(e)}},"x")))})))),l.a.createElement("div",{className:"roster"},p,l.a.createElement("p",null,l.a.createElement("button",{disabled:m,onClick:function(){var e=x.slice(0,16).map(function(e){return f(e)});t.roster.addPlayers(e),d(!0),u([].concat(t.roster.all))}},"Load a demo roster")),l.a.createElement("p",null,"Or add your own players:"),l.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t.roster.addPlayer(f(y.firstName,y.lastName,y.rating)),u([].concat(t.roster.all))}},l.a.createElement("p",null,l.a.createElement("label",null,"First name\xa0",l.a.createElement("input",{type:"text",name:"firstName",onChange:g,required:!0}))),l.a.createElement("p",null,l.a.createElement("label",null,"Last name\xa0",l.a.createElement("input",{type:"text",name:"lastName",onChange:g,required:!0}))),l.a.createElement("p",null,l.a.createElement("label",null,"Rating\xa0",l.a.createElement("input",{type:"number",name:"rating",onChange:g,value:"1200"}))),l.a.createElement("input",{type:"submit",value:"Add"})),l.a.createElement("p",{className:"center"},"Total rounds: ",t.getNumOfRounds()))}function I(e){var t=e.tourney,n=e.roundId,r=t.roundList[n],i=Object(a.useState)(r.matches.map(function(e){return Object.assign({},e)})),u=Object(c.a)(i,2),o=u[0],s=u[1],m=function(e,t,n){var a=r.matches[t];n.target.checked?0===e?a.whiteWon():1===e?a.blackWon():.5===e&&a.draw():a.resetResult(),s(r.matches.map(function(e){return Object.assign({},e)}))};return l.a.createElement("div",{className:"round"},l.a.createElement("table",{className:"table__roster"},l.a.createElement("caption",null,"Round ",r.id+1," results"),l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"#"),l.a.createElement("th",null,"Won"),l.a.createElement("th",null,"White"),l.a.createElement("th",null,"Draw"),l.a.createElement("th",null,"Black"),l.a.createElement("th",null,"Won"),l.a.createElement("th",null))),l.a.createElement("tbody",null,o.map(function(e,r){return l.a.createElement(_,{key:r,tourney:t,roundId:n,matchId:r,setWinner:m})}))),l.a.createElement("p",{style:{textAlign:"center"}},l.a.createElement("button",{onClick:function(){o.forEach(function(e,t){var n=r.matches[t];if(!n.isBye()){var a=Math.random();a>=.55?n.whiteWon():a>=.1?n.blackWon():n.draw()}}),s(r.matches.map(function(e){return Object.assign({},e)}))}},"Random!")),l.a.createElement(L,{roundId:r.id,tourney:r.tourney}))}function _(e){var t=e.tourney,n=e.roundId,r=e.matchId,i=e.setWinner,u=t.roundList[n],s=u.matches[r],m=Object(a.useState)([[]]),f=Object(c.a)(m,2),d=f[0],y=f[1],g=function(e){return void 0!==d[n]&&d[n].includes(e)};return l.a.createElement("tr",{className:s.isBye()?"inactive":""},l.a.createElement("td",{className:"table__number"},r+1),l.a.createElement("td",null,l.a.createElement("input",{type:"checkbox",checked:1===s.getWhite().result,disabled:s.isBye(),onChange:function(e){return i(0,r,e)}})),l.a.createElement("td",{className:"table__player"},s.getWhite().player.firstName,g(r)&&l.a.createElement(T,{tourney:t,round:u,player:s.getWhite().player})),l.a.createElement("td",null,l.a.createElement("input",{type:"checkbox",checked:.5===s.getWhite().result,disabled:s.isBye(),onChange:function(e){return i(.5,r,e)}})),l.a.createElement("td",{className:"table__player"},s.getBlack().player.firstName,g(r)&&l.a.createElement(T,{tourney:t,round:u,player:s.getBlack().player})),l.a.createElement("td",null,l.a.createElement("input",{type:"checkbox",checked:1===s.getBlack().result,disabled:s.isBye(),onChange:function(e){return i(1,r,e)}})),l.a.createElement("td",null,l.a.createElement("button",{onClick:function(){return function(e){var t=Object(o.a)(d);void 0===t[n]&&(t[n]=[]),t[n].includes(e)?(t[n]=t[n].filter(function(t){return t!==e}),y(t)):(t[n]=t[n].concat([e]),y(t))}(r)}},"?"),s.warnings))}function T(e){var t=e.tourney,n=e.round,a=e.player,i=n.getMatchByPlayer(a).getPlayerInfo(a).newRating-n.getMatchByPlayer(a).getPlayerInfo(a).origRating;i>-1&&(i="+"+i);var u=r.playerColorBalance(t,a,n.id),c="Even";return u>0?c="White +"+u:u<0&&(c="Black +"+Math.abs(u)),l.a.createElement("dl",{className:"player-card"},l.a.createElement("dt",null,"Score"),l.a.createElement("dd",null,r.playerScore(t,a,n.id)),l.a.createElement("dt",null,"Rating"),l.a.createElement("dd",null,n.getMatchByPlayer(a).getPlayerInfo(a).origRating,"\xa0(",i,")"),l.a.createElement("dt",null,"Color balance"),l.a.createElement("dd",null,c),l.a.createElement("dt",null,"Opponent history"),l.a.createElement("dd",null,l.a.createElement("ol",null,t.getPlayersByOpponent(a,n.id).map(function(e,t){return l.a.createElement("li",{key:t},e.firstName)}))))}function L(e){var t=e.tourney,n=e.roundId;return l.a.createElement("table",{key:n},l.a.createElement("caption",null,"Current Standings"),l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null),l.a.createElement("th",null,"First name"),l.a.createElement("th",null,"Score"),E.tieBreak.filter(function(e){return e.active}).map(function(e,t){return l.a.createElement("th",{key:t},e.name)}))),r.calcStandings(t,n).map(function(e,t){return l.a.createElement("tbody",{key:t},e.map(function(e,n){return l.a.createElement("tr",{key:n},l.a.createElement("td",null,t+1),l.a.createElement("td",null,e.player.firstName),l.a.createElement("td",{className:"table__number"},e.score),E.tieBreak.filter(function(e){return e.active}).map(function(t,n){return l.a.createElement("td",{className:"table__number",key:n},e[t.func.name])}))}))}))}var z=S("CVL Winter Open");Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(l.a.createElement(function(){var e=Object(a.useState)([{name:"Roster",contents:l.a.createElement(W,{tourney:z})}]),t=Object(c.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(n[0]),u=Object(c.a)(i,2),o=u[0],s=u[1];return l.a.createElement("div",{className:"tournament"},l.a.createElement("nav",{className:"tabbar"},l.a.createElement("ul",null,n.map(function(e,t){return l.a.createElement("li",{key:t},l.a.createElement("button",{className:"tab",onClick:function(){return s(e)},disabled:o===e},e.name))}),l.a.createElement("li",null,l.a.createElement("button",{className:"tab new_round",onClick:function(e){var t=z.newRound();t?(n.push({name:"Round "+(t.id+1),contents:l.a.createElement(I,{tourney:z,roundId:t.id})}),r([].concat(n)),s(n[n.length-1])):alert("Either add players or complete the current matches first.")}},"New Round")))),l.a.createElement("h1",null,"Chessahoochee: a chess tournament app"),o.contents)},null),document.getElementById("root")),u.a.render(l.a.createElement(function(){return l.a.createElement("p",null,l.a.createElement("span",{role:"img","aria-label":"waving hand"},"\ud83d\udc4b"),"\xa0 This is an unstable demo build! Want to help make it better? Head to the\xa0",l.a.createElement("span",{role:"img","aria-label":"finger pointing right"},"\ud83d\udc49"),"\xa0",l.a.createElement("a",{href:"https://github.com/johnridesabike/chessahoochee"},"Git repository"),".")},null),document.getElementById("caution")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},6:function(e){e.exports={tieBreak:[{name:"Modified median",funcName:"modifiedMedian",active:!0},{name:"Solkoff",funcName:"solkoff",active:!0},{name:"Cumulative score",funcName:"playerScoreCum",active:!0},{name:"Cumulative of opposition",funcName:"playerOppScoreCum",active:!0},{name:"Most black",funcName:"playerColorBalance",active:!1}]}}},[[10,1,2]]]);
//# sourceMappingURL=main.f0457c62.chunk.js.map