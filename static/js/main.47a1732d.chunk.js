(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){},13:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),l=n(4),i=n.n(l),o=(n(12),n(1)),u=(n(13),n(6)),c=n(5),s=n(14),h=s.chain,m=s.flatten,p=s.last,f=s.times,d=s.zip,y=n(16),g=n(19).firstBy,E=new y(16);function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1200;if(!(this instanceof v))return new v(e,t,n);this.firstName=e,this.lastName=t,this.rating=n,this.dummy=!1}var b=v("Dummy");function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!(this instanceof w))return new w(e,t,n,r);this.name=e,this.timeControl=t,this.roster={all:n,inactive:[],active:function(){var e=this;return this.all.filter(function(t){return!e.inactive.includes(t)})}},this.roundList=[],this.byeValue=r}function R(e,t,n,r){if(!(this instanceof R))return new R(e,t,n,r);this.roundNum=t,this.tourney=e,this.roster=r,this.prevRound=n,this.playerTree={},this.matches=[],this.hasDummy=!1}function O(e,t,n){if(!(this instanceof O))return new O(e,t,n);this.round=e,this.players=[t,n],this.result=[0,0],this.scoreExpected=[0,0],this.origRating=[t.rating,n.rating],this.newRating=[t.rating,n.rating];var r=this.players.map(function(e){return e.dummy});r[0]?this.result=[0,1]:r[1]&&(this.result=[1,0])}function k(e){var t=e.tourney,n=Object(r.useState)(t.roster.all),l=Object(o.a)(n,2),i=l[0],u=l[1],c={firstName:"",lastName:"",rating:1200},s=function(e){c[e.target.name]=e.target.value};return a.a.createElement("div",{className:"roster"},a.a.createElement("table",null,a.a.createElement("caption",null,"Roster"),a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"First name"),a.a.createElement("th",null,"Rating"))),a.a.createElement("tbody",null,i.map(function(e,t){return a.a.createElement("tr",{key:t},a.a.createElement("td",null,e.firstName),a.a.createElement("td",{className:"table__number"},e.rating))}))),a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t.addPlayer(new v(c.firstName,c.lastName,c.rating)),u([].concat(t.roster.all))}},a.a.createElement("label",null,"First name",a.a.createElement("input",{type:"text",name:"firstName",onChange:s,required:!0})),a.a.createElement("label",null,"Last name",a.a.createElement("input",{type:"text",name:"lastName",onChange:s,required:!0})),a.a.createElement("label",null,"Rating",a.a.createElement("input",{type:"number",name:"rating",onChange:s,value:"1200"})),a.a.createElement("input",{type:"submit",value:"Add"})),a.a.createElement("p",{className:"center"},"Total rounds: ",t.numOfRounds()))}function N(e){var t=e.tourney,n=e.roundNum,l=t.roundList[n],i=Object(r.useState)(l.matches.map(function(e){return Object.assign({},e)})),u=Object(o.a)(i,2),c=u[0],s=u[1],h=function(e,t,n,r){var a=l.matches[n];r.target.checked?0===t?a.whiteWon():1===t?a.blackWon():.5===t&&a.draw():a.resetResult(),s(l.matches.map(function(e){return Object.assign({},e)}))};return a.a.createElement("div",null,a.a.createElement("table",{key:l.roundNum},a.a.createElement("caption",null,"Round ",l.roundNum+1," results"),a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"Won"),a.a.createElement("th",null,"Rating change"),a.a.createElement("th",null,"White"),a.a.createElement("th",null,"Draw"),a.a.createElement("th",null,"Black"),a.a.createElement("th",null,"Rating change"),a.a.createElement("th",null,"Won"))),a.a.createElement("tbody",null,c.map(function(e,t){return a.a.createElement("tr",{key:t},a.a.createElement("td",null,a.a.createElement("form",null,a.a.createElement("input",{type:"checkbox",checked:1===l.matches[t].result[0],onChange:function(e){return h(0,0,t,e)}}))),a.a.createElement("td",null,l.matches[t].newRating[0]-l.matches[t].origRating[0]),a.a.createElement("td",null,l.matches[t].whitePlayer.firstName),a.a.createElement("td",null,a.a.createElement("form",null,a.a.createElement("input",{type:"checkbox",checked:.5===l.matches[t].result[0],onChange:function(e){return h(0,.5,t,e)}}))),a.a.createElement("td",null,l.matches[t].blackPlayer.firstName),a.a.createElement("td",null,l.matches[t].newRating[1]-l.matches[t].origRating[1]),a.a.createElement("td",null,a.a.createElement("form",null,a.a.createElement("input",{type:"checkbox",checked:1===l.matches[t].result[1],onChange:function(e){return h(0,1,t,e)}}))))}))),a.a.createElement(C,{roundNum:l.roundNum,tourney:l.tourney}))}function C(e){var t=e.tourney,n=e.roundNum;return a.a.createElement("table",{key:n},a.a.createElement("caption",null,"Current Standings"),a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"First name"),a.a.createElement("th",null,"Score"),a.a.createElement("th",null,"Median"),a.a.createElement("th",null,"Solkoff"),a.a.createElement("th",null,"Cumulative"),a.a.createElement("th",null,"Cumulative of opposition"),a.a.createElement("th",null,"Rating"),a.a.createElement("th",null,"Color balance"),a.a.createElement("th",null,"Opponent count"))),a.a.createElement("tbody",null,t.playerStandings(n).map(function(e,r){return a.a.createElement("tr",{key:r},a.a.createElement("td",null,e.firstName),a.a.createElement("td",{className:"table__number"},t.playerScore(e,n)),a.a.createElement("td",{className:"table__number"},t.modifiedMedian(e,n)),a.a.createElement("td",{className:"table__number"},t.solkoff(e,n)),a.a.createElement("td",{className:"table__number"},t.playerScoreCum(e,n)),a.a.createElement("td",{className:"table__number"},t.playerOppScoreCum(e,n)),a.a.createElement("td",null,e.rating),a.a.createElement("td",{className:"table__number"},t.playerColorBalance(e,n)),a.a.createElement("td",{className:"table__number"},t.playerOppHistory(e,n).length))})))}b.dummy=!0,b.rating=0,w.prototype.addPlayer=function(e){this.roster.all.push(e)},w.prototype.addPlayers=function(e){this.roster.all=this.roster.all.concat(e)},w.prototype.deactivatePlayer=function(e){this.roster.inactive.push(e)},w.prototype.activatePlayer=function(e){this.roster.inactive.splice(this.roster.inactive.indexOf(e),1)},w.prototype.numOfRounds=function(){return Math.ceil(Math.log2(this.roster.active().length))},w.prototype.calcStandings=function(){return!0},w.prototype.playerScoreList=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=[];return null===n&&(n=this.roundList.length),f(n+1,function(n){void 0!==t.roundList[n]&&t.roundList[n].matches.forEach(function(t){var n=t.players.indexOf(e);-1!==n&&r.push(t.result[n])})}),r},w.prototype.playerScore=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0,r=this.playerScoreList(e,t);return r.length>0&&(n=r.reduce(function(e,t){return e+t})),n},w.prototype.playerScoreCum=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0,r=[];this.playerScoreList(e,t).forEach(function(e){n+=e,r.push(n)});var a=0;return 0!==r.length&&(a=r.reduce(function(e,t){return e+t})),a},w.prototype.playerColorBalance=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=0;return null===n&&(n=this.roundList.length),f(n+1,function(n){void 0!==t.roundList[n]&&t.roundList[n].matches.forEach(function(t){t.players[0]===e?r+=1:t.players[1]===e&&(r+=-1)})}),r},w.prototype.playerStandings=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=[].concat(this.roster.all);return n.sort(g(function(n){return e.playerScore(n,t)},-1).thenBy(function(n){return e.modifiedMedian(n,t)},-1).thenBy(function(n){return e.solkoff(n,t)},-1).thenBy(function(n){return e.playerScoreCum(n,t)},-1).thenBy(function(n){return e.playerOppScoreCum(n,t)},-1)),n},w.prototype.modifiedMedian=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.playerOppHistory(e,n).map(function(e){return t.playerScore(e,n)});a.sort(),r||(a.pop(),a.shift());var l=0;return a.length>0&&(l=a.reduce(function(e,t){return e+t})),l},w.prototype.solkoff=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.modifiedMedian(e,t,!0)},w.prototype.playerOppHistory=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=[];return null===n&&(n=this.roundList.length-1),f(n+1,function(n){t.roundList[n].matches.forEach(function(t){t.players.includes(e)&&(r=r.concat(t.players.filter(function(t){return t!==e}).filter(function(e){return!r.includes(e)})))})}),r},w.prototype.playerOppScoreCum=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.playerOppHistory(e,n).map(function(e){return t.playerScoreCum(e,n)}),a=0;return 0!==r.length&&(a=r.reduce(function(e,t){return e+t})),a},w.prototype.newRound=function(){var e=new R(this,this.roundList.length,p(this.roundList),this.roster.active());return e.pairPlayers(),this.roundList.push(e),e},R.prototype.pairPlayers=function(){var e=this;return this.roster.forEach(function(t){var n=e.tourney.playerScore(t);n in e.playerTree||(e.playerTree[n]=[]),e.playerTree[n].push(t)}),Object.keys(this.playerTree).reverse().forEach(function(t,n,r){var a=e.playerTree[t];if(a.length%2!==0)if(e.roster.length%2===0||e.hasDummy){var l=a[a.length-1];a.splice(a.length-1,1);var i=r[n+1];i in e.playerTree||(e.playerTree[i]=[]),e.playerTree[i].push(l)}else a.push(b),e.hasDummy=!0;0===a.length?delete e.playerTree[t]:e.playerTree[t]=h(a).sortBy("rating").reverse().chunk(a.length/2).value()}),Object.keys(this.playerTree).forEach(function(t){var n=e.playerTree[t][0],r=e.playerTree[t][1];if(void 0===e.prevRound)d(n,r).forEach(function(t){return e.matches.push(Object(u.a)(O,[e].concat(Object(c.a)(t))))});else{try{var a=n.map(function(t){return[].concat(r).concat(n).filter(function(n){return e.tourney.playerOppHistory(n).includes(t)})})}catch(l){throw console.log(t,e.playerTree[t]),l}n.forEach(function(t){var l=a[n.indexOf(t)],i=m(a.slice(n.indexOf(t))),u=e._findAMatch(t,r.filter(function(e){return i.includes(e)}),l),c=Object(o.a)(u,2),s=c[0],h=c[1];if(!s){var p=e._findAMatch(t,r,l),f=Object(o.a)(p,2);s=f[0],h=f[1]}if(!s){var d=e._findAMatch(t,r,[]),y=Object(o.a)(d,2);s=y[0],h=y[1]}if(l.includes(s)){var g=!1;n.filter(function(e){return e!==t}).forEach(function(r){if(!g){var i=e.matches.filter(function(e){return e.players.includes(r)})[0];if(i){var o=i.players.filter(function(e){return e!==r})[0],u=a[n.indexOf(r)];l.includes(o)||u.includes(s)||(h.players=[t,o],i.players=[r,s],g=!0)}}})}})}}),this.matches},R.prototype._findAMatch=function(e,t){var n,r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],l=this.prevRound.playerColor(e),i=t.filter(function(e){return!a.includes(e)}).filter(function(t){return t!==e}).filter(function(e){return!m(r.matches.map(function(e){return e.players})).includes(e)}),o=t.filter(function(e){return l!==r.prevRound.playerColor(e)}),u=i.filter(function(e){return o.includes(e)})[0]||i[0];return u&&(n=new O(this,e,u),this.tourney.playerColorBalance(e)>this.tourney.playerColorBalance(u)&&n.players.reverse(),this.matches.push(n)),[u,n]},R.prototype.playerColor=function(e){var t=-1;return this.matches.forEach(function(n){n.players.includes(e)&&(t=n.players.indexOf(e))}),t},R.prototype.addPlayer=function(e){return this.players.push(e),this},Object.defineProperties(O.prototype,{whitePlayer:{get:function(){return this.players[0]},set:function(e){this.players[0]=e}},blackPlayer:{get:function(){return this.players[1]},set:function(e){this.players[1]=e}},whiteOrigRating:{get:function(){return this.origRating[0]}},blackOrigRating:{get:function(){return this.origRating[1]}},isComplete:{get:function(){return 0!==this.result.reduce(function(e,t){return e+t})}},isBye:{get:function(){return this.players.includes(b)}}}),O.prototype.blackWon=function(){this.result=[0,1],this.calcRatings()},O.prototype.whiteWon=function(){this.result=[1,0],this.calcRatings()},O.prototype.draw=function(){this.result=[.5,.5],this.calcRatings()},R.prototype.resetResult=function(){this.result=[0,0],this.newRating=this.origRating},O.prototype.calcRatings=function(){this.scoreExpected=[E.getExpected(this.whiteOrigRating,this.blackOrigRating),E.getExpected(this.blackOrigRating,this.whiteOrigRating)],this.newRating=[E.updateRating(this.scoreExpected[0],this.result[0],this.whiteOrigRating),E.updateRating(this.scoreExpected[1],this.result[1],this.blackOrigRating)],this.whitePlayer.rating=this.newRating[0],this.blackPlayer.rating=this.newRating[1]};var S=new w("CVL Winter Open",15),_=[new v("Matthew","A",800),new v("Mark","B",850),new v("Luke","C",900),new v("John","D",950),new v("Simon","E",1e3),new v("Andrew","F",1050),new v("James","G",1100),new v("Philip","H",1150),new v("Bartholomew","I",1200),new v("Thomas","J",1250),new v("Catherine","K",1300),new v("Clare","L",1350),new v("Judas","M",1400),new v("Matthias","N",1450),new v("Paul","O",1500),new v("Mary","P",1600),new v("Theresa","Q",1650),new v("Megan","R",1700),new v("Elizabeth","S",1750)];S.addPlayers(_.slice(0,16));var L=function(){var e=Object(r.useState)([{name:"Roster",contents:a.a.createElement(k,{tourney:S})}]),t=Object(o.a)(e,2),n=t[0],l=t[1],i=Object(r.useState)(n[0]),u=Object(o.a)(i,2),c=u[0],s=u[1];return a.a.createElement("div",{className:"tournament"},a.a.createElement("nav",{className:"tabbar"},a.a.createElement("ul",null,n.map(function(e,t){return a.a.createElement("li",{key:t},a.a.createElement("button",{className:"tab",onClick:function(){return s(e)},disabled:c===e},e.name))}),a.a.createElement("li",null,a.a.createElement("button",{className:"tab new_round",onClick:function(e){var t=S.newRound();n.push({name:"Round "+(t.roundNum+1),contents:a.a.createElement(N,{tourney:S,roundNum:t.roundNum})}),l([].concat(n)),s(n[n.length-1])}},"New Round")))),a.a.createElement("h1",null,"Chessahoochee: a chess tournament app"),c.contents)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},7:function(e,t,n){e.exports=n(20)}},[[7,1,2]]]);
//# sourceMappingURL=main.47a1732d.chunk.js.map