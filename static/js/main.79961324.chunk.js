(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(5),l=n.n(i),o=(n(13),n(1));n(14);function c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!(this instanceof c))return new c(e);this.all=e,this.inactive=[]}Object.defineProperties(c.prototype,{active:{get:function(){var e=this;return this.all.filter(function(t){return!e.inactive.includes(t)})}}});var s=c,u=n(7),h=n(6);function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1200;if(!(this instanceof m))return new m(e,t,n);this.dummy=!1,"object"===typeof e?Object.assign(this,e):(this.firstName=e,this.lastName=t,this.rating=n)}var p=m("Dummy");p.dummy=!0,p.rating=0;var f=new(n(15))(16);function d(e,t,n){if(!(this instanceof d))return new d(e,t,n);this.round=e,this.players=[t,n],this.result=[0,0],this.scoreExpected=[0,0],this.origRating=[t.rating,n.rating],this.newRating=[t.rating,n.rating];var r=this.players.map(function(e){return e.dummy});r[0]?this.result=[0,1]:r[1]&&(this.result=[1,0])}Object.defineProperties(d.prototype,{whitePlayer:{get:function(){return this.players[0]},set:function(e){this.players[0]=e}},blackPlayer:{get:function(){return this.players[1]},set:function(e){this.players[1]=e}},whiteOrigRating:{get:function(){return this.origRating[0]}},blackOrigRating:{get:function(){return this.origRating[1]}},isComplete:{get:function(){return 0!==this.result.reduce(function(e,t){return e+t})}},isBye:{get:function(){return this.players.includes(p)}}}),d.prototype.playerInfo=function(e){var t=this.players.indexOf(e);return-1!==t&&{origRating:this.origRating[t],newRating:this.newRating[t],score:this.result[t]}},d.prototype.blackWon=function(){this.result=[0,1],this.calcRatings()},d.prototype.whiteWon=function(){this.result=[1,0],this.calcRatings()},d.prototype.draw=function(){this.result=[.5,.5],this.calcRatings()},d.prototype.resetResult=function(){this.result=[0,0],this.newRating=this.origRating},d.prototype.calcRatings=function(){this.scoreExpected=[f.getExpected(this.whiteOrigRating,this.blackOrigRating),f.getExpected(this.blackOrigRating,this.whiteOrigRating)],this.newRating=[f.updateRating(this.scoreExpected[0],this.result[0],this.whiteOrigRating),f.updateRating(this.scoreExpected[1],this.result[1],this.blackOrigRating)],this.whitePlayer.rating=this.newRating[0],this.blackPlayer.rating=this.newRating[1]};var y=d,g=n(4),v=g.chain,E=g.flatten,b=g.zip;function N(e,t,n,r){if(!(this instanceof N))return new N(e,t,n,r);this.roundNum=t,this.tourney=e,this.roster=r,this.prevRound=n,this.playerTree={},this.matches=[],this.hasDummy=!1}Object.defineProperties(N.prototype,{isComplete:{get:function(){return!this.matches.map(function(e){return e.isComplete}).includes(!1)}}}),N.prototype.pairPlayers=function(){var e=this;return this.roster.forEach(function(t){var n=e.tourney.playerScore(t);n in e.playerTree||(e.playerTree[n]=[]),e.playerTree[n].push(t)}),Object.keys(this.playerTree).reverse().forEach(function(t,n,r){var a=e.playerTree[t];if(a.length%2!==0)if(e.roster.length%2===0||e.hasDummy){var i=a[a.length-1];a.splice(a.length-1,1);var l=r[n+1];l in e.playerTree||(e.playerTree[l]=[]),e.playerTree[l].push(i)}else a.push(p),e.hasDummy=!0;0===a.length?delete e.playerTree[t]:e.playerTree[t]=v(a).sortBy("rating").reverse().chunk(a.length/2).value()}),Object.keys(this.playerTree).forEach(function(t){var n=e.playerTree[t][0],r=e.playerTree[t][1];if(void 0===e.prevRound)b(n,r).forEach(function(t){return e.matches.push(Object(u.a)(y,[e].concat(Object(h.a)(t))))});else{try{var a=n.map(function(t){return[].concat(r).concat(n).filter(function(n){return e.tourney.playerOppHistory(n).includes(t)})})}catch(i){throw console.log(t,e.playerTree[t]),i}n.forEach(function(t){var i=a[n.indexOf(t)],l=E(a.slice(n.indexOf(t))),c=e._findAMatch(t,r.filter(function(e){return l.includes(e)}),i),s=Object(o.a)(c,2),u=s[0],h=s[1];if(!u){var m=e._findAMatch(t,r,i),p=Object(o.a)(m,2);u=p[0],h=p[1]}if(!u){var f=e._findAMatch(t,r,[]),d=Object(o.a)(f,2);u=d[0],h=d[1]}if(i.includes(u)){var y=!1;n.filter(function(e){return e!==t}).forEach(function(r){if(!y){var l=e.matches.filter(function(e){return e.players.includes(r)})[0];if(l){var o=l.players.filter(function(e){return e!==r})[0],c=a[n.indexOf(r)];i.includes(o)||c.includes(u)||(h.players=[t,o],l.players=[r,u],y=!0)}}})}})}}),this.matches},N.prototype._findAMatch=function(e,t){var n,r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=this.prevRound.playerColor(e),l=t.filter(function(e){return!a.includes(e)}).filter(function(t){return t!==e}).filter(function(e){return!E(r.matches.map(function(e){return e.players})).includes(e)}),o=t.filter(function(e){return i!==r.prevRound.playerColor(e)}),c=l.filter(function(e){return o.includes(e)})[0]||l[0];return c&&(n=new y(this,e,c),this.tourney.playerColorBalance(e)>this.tourney.playerColorBalance(c)&&n.players.reverse(),this.matches.push(n)),[c,n]},N.prototype.playerMatch=function(e){var t;return this.matches.forEach(function(n){n.players.includes(e)&&(t=n)}),t},N.prototype.playerColor=function(e){var t=-1;return this.matches.forEach(function(n){n.players.includes(e)&&(t=n.players.indexOf(e))}),t},N.prototype.addPlayer=function(e){return this.players.push(e),this};var R=N,O=n(19).firstBy,w=n(4),k=w.last,C=w.times;function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!(this instanceof S))return new S(e,t,n,r);this.name=e,this.timeControl=t,this.roster=s(n),this.roundList=[],this.byeValue=r}Object.defineProperties(S.prototype,{isNewRoundReady:{get:function(){return this.roundList.length>0?k(this.roundList).isComplete:this.roster.all.length>0}}}),S.prototype.addPlayer=function(e){this.roster.all.push(e)},S.prototype.addPlayers=function(e){this.roster.all=this.roster.all.concat(e)},S.prototype.deactivatePlayer=function(e){this.roster.inactive.push(e)},S.prototype.activatePlayer=function(e){this.roster.inactive.splice(this.roster.inactive.indexOf(e),1)},S.prototype.removePlayer=function(e){return!(this.playerMatchHistory(e).length>0)&&(delete this.roster.all[this.roster.all.indexOf(e)],this)},S.prototype.numOfRounds=function(){var e=Math.ceil(Math.log2(this.roster.active.length));return e===-1/0&&(e=0),e},S.prototype.calcStandings=function(){return!0},S.prototype.playerMatchHistory=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===n&&(n=this.roundList.length);var r=[];return C(n+1,function(n){void 0!==t.roundList[n]&&t.roundList[n].matches.forEach(function(t){-1!==t.players.indexOf(e)&&r.push(t)})}),r},S.prototype.playerScoreList=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.playerMatchHistory(e,t).map(function(t){return t.result[t.players.indexOf(e)]})},S.prototype.playerScore=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0,r=this.playerScoreList(e,t);return r.length>0&&(n=r.reduce(function(e,t){return e+t})),n},S.prototype.playerScoreCum=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0,r=[];this.playerScoreList(e,t).forEach(function(e){n+=e,r.push(n)});var a=0;return 0!==r.length&&(a=r.reduce(function(e,t){return e+t})),a},S.prototype.playerColorBalance=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0;return this.playerMatchHistory(e,t).forEach(function(t){t.players[0]===e?n+=1:t.players[1]===e&&(n+=-1)}),n},S.prototype.playerStandings=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=[].concat(this.roster.all);return n.sort(O(function(n){return e.playerScore(n,t)},-1).thenBy(function(n){return e.modifiedMedian(n,t)},-1).thenBy(function(n){return e.solkoff(n,t)},-1).thenBy(function(n){return e.playerScoreCum(n,t)},-1).thenBy(function(n){return e.playerOppScoreCum(n,t)},-1)),n},S.prototype.modifiedMedian=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.playerOppHistory(e,n).map(function(e){return t.playerScore(e,n)});a.sort(),r||(a.pop(),a.shift());var i=0;return a.length>0&&(i=a.reduce(function(e,t){return e+t})),i},S.prototype.solkoff=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.modifiedMedian(e,t,!0)},S.prototype.playerOppHistory=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[];return this.playerMatchHistory(e,t).forEach(function(t){n=n.concat(t.players.filter(function(t){return t!==e}).filter(function(e){return!n.includes(e)}))}),n},S.prototype.playerOppScoreCum=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.playerOppHistory(e,n).map(function(e){return t.playerScoreCum(e,n)}),a=0;return 0!==r.length&&(a=r.reduce(function(e,t){return e+t})),a},S.prototype.newRound=function(){if(!this.isNewRoundReady)return!1;var e=R(this,this.roundList.length,k(this.roundList),this.roster.active);return e.pairPlayers(),this.roundList.push(e),e};var M=[{firstName:"Matthew",lastName:"A",rating:800},{firstName:"Mark",lastName:"B",rating:850},{firstName:"Luke",lastname:"C",rating:900},{firstName:"John",lastname:"D",rating:950},{firstName:"Simon",lastname:"E",rating:1e3},{firstName:"Andrew",lastname:"F",rating:1050},{firstName:"James",lastname:"G",rating:1100},{firstName:"Philip",lastname:"H",rating:1150},{firstName:"Bartholomew",lastname:"I",rating:1200},{firstName:"Thomas",lastname:"J",rating:1250},{firstName:"Catherine",lastname:"K",rating:1300},{firstName:"Clare",lastname:"L",rating:1350},{firstName:"Judas",lastname:"M",rating:1400},{firstName:"Matthias",lastname:"N",rating:1450},{firstName:"Paul",lastname:"O",rating:1500},{firstName:"Mary",lastname:"P",rating:1600},{firstName:"Theresa",lastname:"Q",rating:1650},{firstName:"Megan",lastname:"R",rating:1700},{firstName:"Elizabeth",lastname:"S",rating:1750}];function P(e){var t=e.tourney,n=Object(r.useState)(t.roster.all),i=Object(o.a)(n,2),l=i[0],c=i[1],s=Object(r.useState)(!1),u=Object(o.a)(s,2),h=u[0],p=u[1],f={firstName:"",lastName:"",rating:1200},d=function(e){f[e.target.name]=e.target.value};return a.a.createElement("div",{className:"roster"},a.a.createElement("table",null,a.a.createElement("caption",null,"Roster"),a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"First name"),a.a.createElement("th",null,"Rating"),a.a.createElement("th",null,"Rounds played"),a.a.createElement("th",null))),a.a.createElement("tbody",null,l.map(function(e,n){return a.a.createElement("tr",{key:n,className:t.roster.inactive.includes(e)?"inactive":"active"},a.a.createElement("td",{className:"table__player"},e.firstName),a.a.createElement("td",{className:"table__number"},e.rating),a.a.createElement("td",{className:"table__number"},t.playerMatchHistory(e).length),a.a.createElement("td",null,t.roster.inactive.includes(e)?a.a.createElement("button",{onClick:function(){return function(e){t.activatePlayer(e),c([].concat(t.roster.all))}(e)}},"Activate"):a.a.createElement("button",{onClick:function(){return function(e){t.removePlayer(e)||t.deactivatePlayer(e),c([].concat(t.roster.all))}(e)}},"Deactivate")))}))),a.a.createElement("p",null,a.a.createElement("button",{disabled:h,onClick:function(){var e=M.slice(0,16).map(function(e){return m(e)});t.addPlayers(e),p(!0),c([].concat(t.roster.all))}},"Load a demo roster")),a.a.createElement("p",null,"Or add your own players:"),a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t.addPlayer(m(f.firstName,f.lastName,f.rating)),c([].concat(t.roster.all))}},a.a.createElement("label",null,"First name",a.a.createElement("input",{type:"text",name:"firstName",onChange:d,required:!0})),a.a.createElement("label",null,"Last name",a.a.createElement("input",{type:"text",name:"lastName",onChange:d,required:!0})),a.a.createElement("label",null,"Rating",a.a.createElement("input",{type:"number",name:"rating",onChange:d,value:"1200"})),a.a.createElement("input",{type:"submit",value:"Add"})),a.a.createElement("p",{className:"center"},"Total rounds: ",t.numOfRounds()))}function j(e){var t=e.tourney,n=e.roundNum,i=t.roundList[n],l=Object(r.useState)(i.matches.map(function(e){return Object.assign({},e)})),c=Object(o.a)(l,2),s=c[0],u=c[1],h=function(e,t,n,r){var a=i.matches[n];r.target.checked?0===t?a.whiteWon():1===t?a.blackWon():.5===t&&a.draw():a.resetResult(),u(i.matches.map(function(e){return Object.assign({},e)}))};return a.a.createElement("div",null,a.a.createElement("table",{key:i.roundNum},a.a.createElement("caption",null,"Round ",i.roundNum+1," results"),a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"Won"),a.a.createElement("th",null,"Rating change"),a.a.createElement("th",null,"White"),a.a.createElement("th",null,"Draw"),a.a.createElement("th",null,"Black"),a.a.createElement("th",null,"Rating change"),a.a.createElement("th",null,"Won"))),a.a.createElement("tbody",null,s.map(function(e,t){return a.a.createElement("tr",{key:t},a.a.createElement("td",null,a.a.createElement("form",null,a.a.createElement("input",{type:"checkbox",checked:1===i.matches[t].result[0],onChange:function(e){return h(0,0,t,e)}}))),a.a.createElement("td",null,i.matches[t].newRating[0]-i.matches[t].origRating[0]),a.a.createElement("td",null,i.matches[t].whitePlayer.firstName),a.a.createElement("td",null,a.a.createElement("form",null,a.a.createElement("input",{type:"checkbox",checked:.5===i.matches[t].result[0],onChange:function(e){return h(0,.5,t,e)}}))),a.a.createElement("td",null,i.matches[t].blackPlayer.firstName),a.a.createElement("td",null,i.matches[t].newRating[1]-i.matches[t].origRating[1]),a.a.createElement("td",null,a.a.createElement("form",null,a.a.createElement("input",{type:"checkbox",checked:1===i.matches[t].result[1],onChange:function(e){return h(0,1,t,e)}}))))}))),a.a.createElement(_,{roundNum:i.roundNum,tourney:i.tourney}))}function _(e){var t=e.tourney,n=e.roundNum,r=t.roundList[n];return a.a.createElement("table",{key:n},a.a.createElement("caption",null,"Current Standings"),a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"First name"),a.a.createElement("th",null,"Score"),a.a.createElement("th",null,"Median"),a.a.createElement("th",null,"Solkoff"),a.a.createElement("th",null,"Cumulative"),a.a.createElement("th",null,"Cumulative of opposition"),a.a.createElement("th",null,"Rating"),a.a.createElement("th",null,"Color balance"),a.a.createElement("th",null,"Opponent count"))),a.a.createElement("tbody",null,t.playerStandings(n).map(function(e,i){return a.a.createElement("tr",{key:i},a.a.createElement("td",null,e.firstName),a.a.createElement("td",{className:"table__number"},t.playerScore(e,n)),a.a.createElement("td",{className:"table__number"},t.modifiedMedian(e,n)),a.a.createElement("td",{className:"table__number"},t.solkoff(e,n)),a.a.createElement("td",{className:"table__number"},t.playerScoreCum(e,n)),a.a.createElement("td",{className:"table__number"},t.playerOppScoreCum(e,n)),a.a.createElement("td",null,r.playerMatch(e)?r.playerMatch(e).playerInfo(e).newRating:t.playerMatchHistory(e)[t.playerMatchHistory(e).length-1].playerInfo(e).newRating),a.a.createElement("td",{className:"table__number"},t.playerColorBalance(e,n)),a.a.createElement("td",{className:"table__number"},t.playerOppHistory(e,n).length))})))}var x=new S("CVL Winter Open",15);var L=function(){var e=Object(r.useState)([{name:"Roster",contents:a.a.createElement(P,{tourney:x})}]),t=Object(o.a)(e,2),n=t[0],i=t[1],l=Object(r.useState)(n[0]),c=Object(o.a)(l,2),s=c[0],u=c[1];return a.a.createElement("div",{className:"tournament"},a.a.createElement("nav",{className:"tabbar"},a.a.createElement("ul",null,n.map(function(e,t){return a.a.createElement("li",{key:t},a.a.createElement("button",{className:"tab",onClick:function(){return u(e)},disabled:s===e},e.name))}),a.a.createElement("li",null,a.a.createElement("button",{className:"tab new_round",onClick:function(e){var t=x.newRound();t?(n.push({name:"Round "+(t.roundNum+1),contents:a.a.createElement(j,{tourney:x,roundNum:t.roundNum})}),i([].concat(n)),u(n[n.length-1])):alert("Either add players or complete the current matches first.")}},"New Round")))),a.a.createElement("h1",null,"Chessahoochee: a chess tournament app"),s.contents)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(a.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},8:function(e,t,n){e.exports=n(20)}},[[8,1,2]]]);
//# sourceMappingURL=main.79961324.chunk.js.map