(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e){e.exports=[{firstName:"Matthew",lastName:"A",rating:800},{firstName:"Mark",lastName:"B",rating:850},{firstName:"Luke",lastname:"C",rating:900},{firstName:"John",lastname:"D",rating:950},{firstName:"Simon",lastname:"E",rating:1e3},{firstName:"Andrew",lastname:"F",rating:1050},{firstName:"James",lastname:"G",rating:1100},{firstName:"Philip",lastname:"H",rating:1150},{firstName:"Bartholomew",lastname:"I",rating:1200},{firstName:"Thomas",lastname:"J",rating:1250},{firstName:"Catherine",lastname:"K",rating:1300},{firstName:"Clare",lastname:"L",rating:1350},{firstName:"Judas",lastname:"M",rating:1400},{firstName:"Matthias",lastname:"N",rating:1450},{firstName:"Paul",lastname:"O",rating:1500},{firstName:"Mary",lastname:"P",rating:1600},{firstName:"Theresa",lastname:"Q",rating:1650},{firstName:"Megan",lastname:"R",rating:1700},{firstName:"Elizabeth",lastname:"S",rating:1750}]},13:function(e,t,n){e.exports=n(23)},18:function(e,t,n){},19:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"calcStandings",function(){return M}),n.d(r,"modifiedMedian",function(){return C}),n.d(r,"playerColorBalance",function(){return w}),n.d(r,"playerOppScoreCum",function(){return j}),n.d(r,"playerScore",function(){return R}),n.d(r,"playerScoreCum",function(){return k}),n.d(r,"playerScoreList",function(){return O}),n.d(r,"solkoff",function(){return P});var a=n(0),l=n.n(a),u=n(5),i=n.n(u),c=(n(18),n(2)),o=(n(19),n(4)),s=n(9),m=n.n(s);function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1200,r={firstName:"",lastName:"",rating:0,dummy:!1,Ne:0,eloRank:function(e){var t=e.getMatchesByPlayer(r).length,n=800/(r.Ne+t);return new m.a(n)},hasHadBye:function(e){return e.getPlayersByOpponent(r).includes(d)}};return"object"===typeof e?Object.assign(r,e):(r.firstName=e,r.lastName=t,r.rating=n),r}var d=Object.freeze(f({firstName:"Bye",dummy:!0,rating:0}));function g(e){var t=e.players[0].eloRank(e.tourney),n=e.players[1].eloRank(e.tourney),r=[t.getExpected(e.origRating[0],e.origRating[1]),n.getExpected(e.origRating[1],e.origRating[0])];return e.newRating=[t.updateRating(r[0],e.result[0],e.origRating[0]),n.updateRating(r[1],e.result[1],e.origRating[1])],e.newRating=e.newRating.map(function(e){return e<100?100:e}),e.players[0].rating=e.newRating[0],e.players[1].rating=e.newRating[1],e}var y=Object.freeze(function(e,t,n){var r={round:e,tourney:e.tourney,warnings:"",players:[t,n],result:[0,0],origRating:[t.rating,n.rating],newRating:[t.rating,n.rating],ideal:0,reverse:function(){return r.players.reverse(),r.result.reverse(),r.origRating.reverse(),r.newRating.reverse(),r},blackWon:function(){return r.result=[0,1],g(r),r},whiteWon:function(){return r.result=[1,0],g(r),r},draw:function(){return r.result=[.5,.5],g(r),r},resetResult:function(){return r.result=[0,0],r.newRating=Object(o.a)(r.origRating),r.players[0].rating=r.newRating[0],r.players[1].rating=r.newRating[1],r},isComplete:function(){return r.result[0]+r.result[1]!==0},isBye:function(){return r.players.includes(d)},getColorInfo:function(e){return{player:r.players[e],result:r.result[e],origRating:r.origRating[e],newRating:r.newRating[e]}},getPlayerColor:function(e){return r.players.indexOf(e)},getPlayerInfo:function(e){return r.getColorInfo(r.getPlayerColor(e))},getWhite:function(){return r.getColorInfo(0)},getBlack:function(){return r.getColorInfo(1)}};return r.players[0]===d?r.result=[0,1]:r.players[1]===d&&(r.result=[1,0]),r});var p=Object.freeze(function(e){var t={tourney:e,all:arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],inactive:[],getActive:function(){return t.all.filter(function(e){return!t.inactive.includes(e)})},addPlayer:function(e){return t.all.push(e),t},addPlayers:function(e){return t.all=t.all.concat(e),t},deactivatePlayer:function(e){return t.inactive.push(e),t},activatePlayer:function(e){return t.inactive.splice(t.inactive.indexOf(e),1),t},removePlayer:function(e){return t.tourney.getMatchesByPlayer(e).length>0?null:(delete t.all[t.all.indexOf(e)],t)}};return t}),h=n(1),v=n(3),E=n(10),b=n.n(E),N=n(6);N.tieBreak.forEach(function(e){e.func=r[e.funcName]});var B=Object.freeze(N);function O(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.getMatchesByPlayer(t,n).map(function(e){return e.result[e.players.indexOf(t)]})}function R(e,t){var n=0,r=O(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null);return r.length>0&&(n=r.reduce(function(e,t){return e+t})),n}function k(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=0,a=[];(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return e.getMatchesByPlayer(t,n).filter(function(e){return!e.isBye()}).map(function(e){return e.result[e.players.indexOf(t)]})})(e,t,n).forEach(function(e){r+=e,a.push(r)});var l=0;return 0!==a.length&&(l=a.reduce(function(e,t){return e+t})),l}function w(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=0;return e.getMatchesByPlayer(t,n).filter(function(e){return!e.isBye()}).forEach(function(e){e.players[0]===t?r+=1:e.players[1]===t&&(r+=-1)}),r}function C(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.getPlayersByOpponent(t,n).filter(function(e){return e!==d}).map(function(t){return R(e,t,n)});a.sort(),r||(a.pop(),a.shift());var l=0;return a.length>0&&(l=a.reduce(function(e,t){return e+t})),l}function P(e,t){return C(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,!0)}function j(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=e.getPlayersByOpponent(t,n).filter(function(e){return e!==d}).map(function(t){return k(e,t,n)}),a=0;return 0!==r.length&&(a=r.reduce(function(e,t){return e+t})),a}function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=B.tieBreak.filter(function(e){return e.active}),r=e.roster.all.map(function(r){var a={player:r,score:R(e,r,t)};return n.forEach(function(n){a[n.func.name]=n.func(e,r,t)}),a}),a=Object(v.firstBy)(function(e){return e.score},-1);n.forEach(function(e){a=a.thenBy(function(t){return t[e.func.name]},-1)}),r.sort(a);var l=[],u=0;return r.forEach(function(e,t,n){0!==t&&(function(e,t){var n=Object.getOwnPropertyNames(e),r=!0;return n.forEach(function(n){"player"!==n&&e[n]!==t[n]&&(r=!1)}),r}(e,n[t-1])||(u+=1));l[u]||(l[u]=[]),l[u].push(e)}),l}var S=32,W=16,x=4,I=2,_=S+W+x+I;var L=Object.freeze(function(e){var t,n,r,a,l,u=e.tourney,i=function(t){if(void 0===e.prevRound)return null;var n=0;return 0===e.prevRound.playerColor(t)&&(n=1),n},c=e.roster.map(function(t,n){return{player:t,id:n,score:R(u,t,e.id),dueColor:i(t),colorBalance:w(u,t),opponentHistory:u.getPlayersByOpponent(t),upperHalf:!1}}),o=Array.from(new Set(c.map(function(e){return e.score})));return o.sort(),c.sort(Object(v.firstBy)(function(e){return e.score},-1).thenBy(function(e){return e.player.rating},-1)),c.length%2!==0&&((n=Object(h.last)(c.filter(function(e){return!e.player.hasHadBye(u)})))||(n=Object(h.last)(c)),t=y(e,n.player,d),c=c.filter(function(e){return e!==n})),o.forEach(function(e){var t=c.filter(function(t){return t.score===e});t.sort(function(e){return e.player.rating}).reverse(),t.length>1&&Object(h.chunk)(t,t.length/2)[0].forEach(function(e){e.upperHalf=!0})}),r=c.reduce(function(e,t,n,r){var a=r.filter(function(e){return e!==t}).map(function(e){var n,r=0;return t.opponentHistory.includes(e.player)||(r+=S),n=Math.abs(o.indexOf(t.score)-o.indexOf(e.score)),n=(o.length-n)/o.length,r+=W*n,t.score===e.score&&t.upperHalf!==e.upperHalf&&(r+=x),null===t.dueColor?r+=I:t.dueColor!==e.dueColor&&(r+=I),[t.id,e.id,Math.ceil(r)]});return e=e.concat(a)},[]),(l=b()(r).reduce(function(e,t,n){if(-1!==t){var a=c.filter(function(e){return e.id===t})[0],l=c.filter(function(e){return e.id===n})[0],u=r.filter(function(e){return e[0]===t&&e[1]===n})[0][2],i=e.map(function(e){return e[0]});i.includes(a)||i.includes(l)||e.push([a,l,u])}return e},[])).sort(Object(v.firstBy)(function(e){return e[0].score+e[1].score},-1).thenBy(function(e){return e[0].rating+e[1].rating},-1)),a=l.map(function(t){var n=t[0],r=t[1],a=t[2],l=y(e,n.player,r.player);return l.ideal=a/_,n.colorBalance>r.colorBalance&&l.reverse(),n.opponentHistory.includes(r.player)&&(l.warnings+=" "+n.player.firstName+" and "+r.player.firstName+" have played previously."),[n,r].forEach(function(e){Math.abs(e.colorBalance)>2&&(l.warnings+=" "+e.player.firstName+"'s color balance is off")}),l}),t&&a.push(t),a});var H=Object.freeze(function(e){var t={id:e.roundList.length,tourney:e,roster:e.roster.getActive(),prevRound:Object(h.last)(e.roundList),matches:[],isComplete:function(){return!t.matches.map(function(e){return e.isComplete()}).includes(!1)},getMatchByPlayer:function(e){var n=null;return t.matches.forEach(function(t){t.players.includes(e)&&(n=t)}),n},playerColor:function(e){var n=-1,r=t.getMatchByPlayer(e);return r&&(n=r.getPlayerColor(e)),n},addPlayer:function(e){return t.players.push(e),t},hasDummy:function(){return t.roster.includes(d)}};return t.matches=L(t),t});var A=Object.freeze(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n={name:e,roundList:[],byeValue:1,isNewRoundReady:function(){return n.roundList.length>0?Object(h.last)(n.roundList).isComplete():n.roster.all.length>0},getMatchesByPlayer:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null===t&&(t=n.roundList.length);var r=[];return Object(h.times)(t+1,function(t){void 0!==n.roundList[t]&&n.roundList[t].matches.forEach(function(t){-1!==t.players.indexOf(e)&&r.push(t)})}),r},getPlayersByOpponent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=[];return n.getMatchesByPlayer(e,t).forEach(function(t){r=r.concat(t.players.filter(function(t){return t!==e}))}),r},getNumOfRounds:function(){var e=Math.ceil(Math.log2(n.roster.getActive().length));return e===-1/0&&(e=0),e},newRound:function(){if(!n.isNewRoundReady())return!1;var e=H(n);return n.roundList.push(e),e}};return n.roster=p(n,t),n}),z=n(11),J=n.n(z),D=n(12);function F(e){var t=e.tourney,n=Object(a.useState)(t.roster.all),r=Object(c.a)(n,2),u=r[0],i=r[1],o={firstName:"",lastName:"",rating:1200},s=function(e){o[e.target.name]=e.target.value},m="";return u.length>0&&(m=l.a.createElement("table",null,l.a.createElement("caption",null,"Roster"),l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"First name"),l.a.createElement("th",null,"Rating"),l.a.createElement("th",null,"Rounds played"),l.a.createElement("th",null))),l.a.createElement("tbody",null,u.map(function(e,n){return l.a.createElement("tr",{key:n,className:t.roster.inactive.includes(e)?"inactive":"active"},l.a.createElement("td",{className:"table__player"},e.firstName),l.a.createElement("td",{className:"table__number"},e.rating),l.a.createElement("td",{className:"table__number"},t.getMatchesByPlayer(e).length),l.a.createElement("td",null,t.roster.inactive.includes(e)?l.a.createElement("button",{onClick:function(){return function(e){t.roster.activatePlayer(e),i([].concat(t.roster.all))}(e)}},"Activate"):l.a.createElement("button",{onClick:function(){return function(e){t.roster.removePlayer(e)||t.roster.deactivatePlayer(e),i([].concat(t.roster.all))}(e)}},"x")))})))),l.a.createElement("div",{className:"roster"},m,l.a.createElement("p",null,l.a.createElement("button",{onClick:function(){var e=D.slice(0,16).map(function(e){return f(e)});t.roster.addPlayers(e),i([].concat(t.roster.all))}},"Load a demo roster")),l.a.createElement("p",null,"Or add your own players:"),l.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t.roster.addPlayer(f(o.firstName,o.lastName,o.rating)),i([].concat(t.roster.all))}},l.a.createElement("p",null,l.a.createElement("label",null,"First name\xa0",l.a.createElement("input",{type:"text",name:"firstName",onChange:s,required:!0}))),l.a.createElement("p",null,l.a.createElement("label",null,"Last name\xa0",l.a.createElement("input",{type:"text",name:"lastName",onChange:s,required:!0}))),l.a.createElement("p",null,l.a.createElement("label",null,"Rating\xa0",l.a.createElement("input",{type:"number",name:"rating",onChange:s,value:"1200"}))),l.a.createElement("input",{type:"submit",value:"Add"})),l.a.createElement("p",{className:"center"},"Total rounds: ",t.getNumOfRounds()))}function T(e){var t=e.tourney,n=e.roundId,r=t.roundList[n],u=Object(a.useState)(r.matches.map(function(e){return Object.assign({},e)})),i=Object(c.a)(u,2),o=i[0],s=i[1],m=function(e,t,n){var a=r.matches[t];n.target.checked?0===e?a.whiteWon():1===e?a.blackWon():.5===e&&a.draw():a.resetResult(),s(r.matches.map(function(e){return Object.assign({},e)}))};return l.a.createElement("div",{className:"round"},l.a.createElement("table",{className:"table__roster"},l.a.createElement("caption",null,"Round ",r.id+1," results"),l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"#"),l.a.createElement("th",null,"Won"),l.a.createElement("th",null,"White"),l.a.createElement("th",null,"Draw"),l.a.createElement("th",null,"Black"),l.a.createElement("th",null,"Won"),l.a.createElement("th",null))),l.a.createElement("tbody",null,o.map(function(e,r){return l.a.createElement(q,{key:r,tourney:t,roundId:n,matchId:r,setWinner:m})}))),l.a.createElement("p",{style:{textAlign:"center"}},l.a.createElement("button",{onClick:function(){o.forEach(function(e,t){var n=r.matches[t];if(!n.isBye()){var a=Math.random();a>=.55?n.whiteWon():a>=.1?n.blackWon():n.draw()}}),s(r.matches.map(function(e){return Object.assign({},e)}))}},"Random!")),l.a.createElement(V,{roundId:r.id,tourney:r.tourney}))}function q(e){var t=e.tourney,n=e.roundId,r=e.matchId,u=e.setWinner,i=t.roundList[n],s=i.matches[r],m=Object(a.useState)([[]]),f=Object(c.a)(m,2),d=f[0],g=f[1],y=function(e){return void 0!==d[n]&&d[n].includes(e)};return l.a.createElement("tr",{className:s.isBye()?"inactive":""},l.a.createElement("td",{className:"table__number"},r+1),l.a.createElement("td",null,l.a.createElement("input",{type:"checkbox",checked:1===s.getWhite().result,disabled:s.isBye(),onChange:function(e){return u(0,r,e)}})),l.a.createElement("td",{className:"table__player"},s.getWhite().player.firstName,y(r)&&l.a.createElement(G,{tourney:t,round:i,player:s.getWhite().player})),l.a.createElement("td",null,l.a.createElement("input",{type:"checkbox",checked:.5===s.getWhite().result,disabled:s.isBye(),onChange:function(e){return u(.5,r,e)}})),l.a.createElement("td",{className:"table__player"},s.getBlack().player.firstName,y(r)&&l.a.createElement(G,{tourney:t,round:i,player:s.getBlack().player})),l.a.createElement("td",null,l.a.createElement("input",{type:"checkbox",checked:1===s.getBlack().result,disabled:s.isBye(),onChange:function(e){return u(1,r,e)}})),l.a.createElement("td",null,l.a.createElement("button",{onClick:function(){return function(e){var t=Object(o.a)(d);void 0===t[n]&&(t[n]=[]),t[n].includes(e)?(t[n]=t[n].filter(function(t){return t!==e}),g(t)):(t[n]=t[n].concat([e]),g(t))}(r)}},"?"),s.warnings))}function G(e){var t=e.tourney,n=e.round,a=e.player,u=n.getMatchByPlayer(a).getPlayerInfo(a).newRating-n.getMatchByPlayer(a).getPlayerInfo(a).origRating;u>-1&&(u="+"+u);var i=r.playerColorBalance(t,a,n.id),c="Even";return i>0?c="White +"+i:i<0&&(c="Black +"+Math.abs(i)),l.a.createElement("dl",{className:"player-card"},l.a.createElement("dt",null,"Score"),l.a.createElement("dd",null,r.playerScore(t,a,n.id)),l.a.createElement("dt",null,"Rating"),l.a.createElement("dd",null,n.getMatchByPlayer(a).getPlayerInfo(a).origRating,"\xa0(",u,")"),l.a.createElement("dt",null,"Color balance"),l.a.createElement("dd",null,c),l.a.createElement("dt",null,"Opponent history"),l.a.createElement("dd",null,l.a.createElement("ol",null,t.getPlayersByOpponent(a,n.id).map(function(e,t){return l.a.createElement("li",{key:t},e.firstName)}))),l.a.createElement("dt",null,"Match ideal"),l.a.createElement("dd",null,J()(n.getMatchByPlayer(a).ideal).format("00%")))}function V(e){var t=e.tourney,n=e.roundId;return l.a.createElement("table",{key:n},l.a.createElement("caption",null,"Current Standings"),l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null),l.a.createElement("th",null,"First name"),l.a.createElement("th",null,"Score"),B.tieBreak.filter(function(e){return e.active}).map(function(e,t){return l.a.createElement("th",{key:t},e.name)}))),r.calcStandings(t,n).map(function(e,t){return l.a.createElement("tbody",{key:t},e.map(function(e,n){return l.a.createElement("tr",{key:n},l.a.createElement("td",null,t+1),l.a.createElement("td",null,e.player.firstName),l.a.createElement("td",{className:"table__number"},e.score),B.tieBreak.filter(function(e){return e.active}).map(function(t,n){return l.a.createElement("td",{className:"table__number",key:n},e[t.func.name])}))}))}))}var K=A("CVL Winter Open");Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(l.a.createElement(function(){var e=Object(a.useState)([{name:"Roster",contents:l.a.createElement(F,{tourney:K})}]),t=Object(c.a)(e,2),n=t[0],r=t[1],u=Object(a.useState)(n[0]),i=Object(c.a)(u,2),o=i[0],s=i[1];return l.a.createElement("div",{className:"tournament"},l.a.createElement("nav",{className:"tabbar"},l.a.createElement("ul",null,n.map(function(e,t){return l.a.createElement("li",{key:t},l.a.createElement("button",{className:"tab",onClick:function(){return s(e)},disabled:o===e},e.name))}),l.a.createElement("li",null,l.a.createElement("button",{className:"tab new_round",onClick:function(e){var t=K.newRound();t?(n.push({name:"Round "+(t.id+1),contents:l.a.createElement(T,{tourney:K,roundId:t.id})}),r([].concat(n)),s(n[n.length-1])):alert("Either add players or complete the current matches first.")}},"New Round")))),l.a.createElement("h1",null,"Chessahoochee: a chess tournament app"),o.contents)},null),document.getElementById("root")),i.a.render(l.a.createElement(function(){return l.a.createElement("p",null,l.a.createElement("span",{role:"img","aria-label":"waving hand"},"\ud83d\udc4b"),"\xa0 This is an unstable demo build! Want to help make it better? Head to the\xa0",l.a.createElement("span",{role:"img","aria-label":"finger pointing right"},"\ud83d\udc49"),"\xa0",l.a.createElement("a",{href:"https://github.com/johnridesabike/chessahoochee"},"Git repository"),".")},null),document.getElementById("caution")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},6:function(e){e.exports={tieBreak:[{name:"Modified median",funcName:"modifiedMedian",active:!0},{name:"Solkoff",funcName:"solkoff",active:!0},{name:"Cumulative score",funcName:"playerScoreCum",active:!0},{name:"Cumulative of opposition",funcName:"playerOppScoreCum",active:!0},{name:"Most black",funcName:"playerColorBalance",active:!1}]}}},[[13,1,2]]]);
//# sourceMappingURL=main.ff0270c8.chunk.js.map