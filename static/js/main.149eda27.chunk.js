(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{12:function(e,t,n){},13:function(e,t,n){},20:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(4),l=n.n(i),o=(n(12),n(1)),s=(n(13),n(6)),u=n(5),c=n(14),h=c.chain,m=c.flatten,p=c.last,f=c.times,d=c.zip,y=n(16),g=n(19).firstBy,E=new y(16);function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1200;if(!(this instanceof v))return new v(e,t,n);this.dummy=!1,"object"===typeof e?Object.assign(this,e):(this.firstName=e,this.lastName=t,this.rating=n)}var b=v("Dummy");function N(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;if(!(this instanceof N))return new N(e,t,n,r);this.name=e,this.timeControl=t,this.roster={all:n,inactive:[],active:function(){var e=this;return this.all.filter(function(t){return!e.inactive.includes(t)})}},this.roundList=[],this.byeValue=r}function R(e,t,n,r){if(!(this instanceof R))return new R(e,t,n,r);this.roundNum=t,this.tourney=e,this.roster=r,this.prevRound=n,this.playerTree={},this.matches=[],this.hasDummy=!1}function O(e,t,n){if(!(this instanceof O))return new O(e,t,n);this.round=e,this.players=[t,n],this.result=[0,0],this.scoreExpected=[0,0],this.origRating=[t.rating,n.rating],this.newRating=[t.rating,n.rating];var r=this.players.map(function(e){return e.dummy});r[0]?this.result=[0,1]:r[1]&&(this.result=[1,0])}b.dummy=!0,b.rating=0,N.prototype.addPlayer=function(e){this.roster.all.push(e)},N.prototype.addPlayers=function(e){this.roster.all=this.roster.all.concat(e)},N.prototype.deactivatePlayer=function(e){this.roster.inactive.push(e)},N.prototype.activatePlayer=function(e){this.roster.inactive.splice(this.roster.inactive.indexOf(e),1)},N.prototype.numOfRounds=function(){var e=Math.ceil(Math.log2(this.roster.active().length));return e===-1/0&&(e=0),e},N.prototype.calcStandings=function(){return!0},N.prototype.playerScoreList=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=[];return null===n&&(n=this.roundList.length),f(n+1,function(n){void 0!==t.roundList[n]&&t.roundList[n].matches.forEach(function(t){var n=t.players.indexOf(e);-1!==n&&r.push(t.result[n])})}),r},N.prototype.playerScore=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0,r=this.playerScoreList(e,t);return r.length>0&&(n=r.reduce(function(e,t){return e+t})),n},N.prototype.playerScoreCum=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=0,r=[];this.playerScoreList(e,t).forEach(function(e){n+=e,r.push(n)});var a=0;return 0!==r.length&&(a=r.reduce(function(e,t){return e+t})),a},N.prototype.playerColorBalance=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=0;return null===n&&(n=this.roundList.length),f(n+1,function(n){void 0!==t.roundList[n]&&t.roundList[n].matches.forEach(function(t){t.players[0]===e?r+=1:t.players[1]===e&&(r+=-1)})}),r},N.prototype.playerStandings=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=[].concat(this.roster.all);return n.sort(g(function(n){return e.playerScore(n,t)},-1).thenBy(function(n){return e.modifiedMedian(n,t)},-1).thenBy(function(n){return e.solkoff(n,t)},-1).thenBy(function(n){return e.playerScoreCum(n,t)},-1).thenBy(function(n){return e.playerOppScoreCum(n,t)},-1)),n},N.prototype.modifiedMedian=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.playerOppHistory(e,n).map(function(e){return t.playerScore(e,n)});a.sort(),r||(a.pop(),a.shift());var i=0;return a.length>0&&(i=a.reduce(function(e,t){return e+t})),i},N.prototype.solkoff=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.modifiedMedian(e,t,!0)},N.prototype.playerOppHistory=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=[];return null===n&&(n=this.roundList.length-1),f(n+1,function(n){t.roundList[n].matches.forEach(function(t){t.players.includes(e)&&(r=r.concat(t.players.filter(function(t){return t!==e}).filter(function(e){return!r.includes(e)})))})}),r},N.prototype.playerOppScoreCum=function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.playerOppHistory(e,n).map(function(e){return t.playerScoreCum(e,n)}),a=0;return 0!==r.length&&(a=r.reduce(function(e,t){return e+t})),a},N.prototype.newRound=function(){if(!this.isNewRoundReady)return!1;var e=R(this,this.roundList.length,p(this.roundList),this.roster.active());return e.pairPlayers(),this.roundList.push(e),e},Object.defineProperties(N.prototype,{isNewRoundReady:{get:function(){return this.roundList.length>0?p(this.roundList).isComplete:this.roster.all.length>0}}}),R.prototype.pairPlayers=function(){var e=this;return this.roster.forEach(function(t){var n=e.tourney.playerScore(t);n in e.playerTree||(e.playerTree[n]=[]),e.playerTree[n].push(t)}),Object.keys(this.playerTree).reverse().forEach(function(t,n,r){var a=e.playerTree[t];if(a.length%2!==0)if(e.roster.length%2===0||e.hasDummy){var i=a[a.length-1];a.splice(a.length-1,1);var l=r[n+1];l in e.playerTree||(e.playerTree[l]=[]),e.playerTree[l].push(i)}else a.push(b),e.hasDummy=!0;0===a.length?delete e.playerTree[t]:e.playerTree[t]=h(a).sortBy("rating").reverse().chunk(a.length/2).value()}),Object.keys(this.playerTree).forEach(function(t){var n=e.playerTree[t][0],r=e.playerTree[t][1];if(void 0===e.prevRound)d(n,r).forEach(function(t){return e.matches.push(Object(s.a)(O,[e].concat(Object(u.a)(t))))});else{try{var a=n.map(function(t){return[].concat(r).concat(n).filter(function(n){return e.tourney.playerOppHistory(n).includes(t)})})}catch(i){throw console.log(t,e.playerTree[t]),i}n.forEach(function(t){var i=a[n.indexOf(t)],l=m(a.slice(n.indexOf(t))),s=e._findAMatch(t,r.filter(function(e){return l.includes(e)}),i),u=Object(o.a)(s,2),c=u[0],h=u[1];if(!c){var p=e._findAMatch(t,r,i),f=Object(o.a)(p,2);c=f[0],h=f[1]}if(!c){var d=e._findAMatch(t,r,[]),y=Object(o.a)(d,2);c=y[0],h=y[1]}if(i.includes(c)){var g=!1;n.filter(function(e){return e!==t}).forEach(function(r){if(!g){var l=e.matches.filter(function(e){return e.players.includes(r)})[0];if(l){var o=l.players.filter(function(e){return e!==r})[0],s=a[n.indexOf(r)];i.includes(o)||s.includes(c)||(h.players=[t,o],l.players=[r,c],g=!0)}}})}})}}),this.matches},R.prototype._findAMatch=function(e,t){var n,r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=this.prevRound.playerColor(e),l=t.filter(function(e){return!a.includes(e)}).filter(function(t){return t!==e}).filter(function(e){return!m(r.matches.map(function(e){return e.players})).includes(e)}),o=t.filter(function(e){return i!==r.prevRound.playerColor(e)}),s=l.filter(function(e){return o.includes(e)})[0]||l[0];return s&&(n=new O(this,e,s),this.tourney.playerColorBalance(e)>this.tourney.playerColorBalance(s)&&n.players.reverse(),this.matches.push(n)),[s,n]},R.prototype.playerColor=function(e){var t=-1;return this.matches.forEach(function(n){n.players.includes(e)&&(t=n.players.indexOf(e))}),t},R.prototype.addPlayer=function(e){return this.players.push(e),this},Object.defineProperties(R.prototype,{isComplete:{get:function(){return!this.matches.map(function(e){return e.isComplete}).includes(!1)}}}),Object.defineProperties(O.prototype,{whitePlayer:{get:function(){return this.players[0]},set:function(e){this.players[0]=e}},blackPlayer:{get:function(){return this.players[1]},set:function(e){this.players[1]=e}},whiteOrigRating:{get:function(){return this.origRating[0]}},blackOrigRating:{get:function(){return this.origRating[1]}},isComplete:{get:function(){return 0!==this.result.reduce(function(e,t){return e+t})}},isBye:{get:function(){return this.players.includes(b)}}}),O.prototype.blackWon=function(){this.result=[0,1],this.calcRatings()},O.prototype.whiteWon=function(){this.result=[1,0],this.calcRatings()},O.prototype.draw=function(){this.result=[.5,.5],this.calcRatings()},O.prototype.resetResult=function(){this.result=[0,0],this.newRating=this.origRating},O.prototype.calcRatings=function(){this.scoreExpected=[E.getExpected(this.whiteOrigRating,this.blackOrigRating),E.getExpected(this.blackOrigRating,this.whiteOrigRating)],this.newRating=[E.updateRating(this.scoreExpected[0],this.result[0],this.whiteOrigRating),E.updateRating(this.scoreExpected[1],this.result[1],this.blackOrigRating)],this.whitePlayer.rating=this.newRating[0],this.blackPlayer.rating=this.newRating[1]};var w=[{firstName:"Matthew",lastName:"A",rating:800},{firstName:"Mark",lastName:"B",rating:850},{firstName:"Luke",lastname:"C",rating:900},{firstName:"John",lastname:"D",rating:950},{firstName:"Simon",lastname:"E",rating:1e3},{firstName:"Andrew",lastname:"F",rating:1050},{firstName:"James",lastname:"G",rating:1100},{firstName:"Philip",lastname:"H",rating:1150},{firstName:"Bartholomew",lastname:"I",rating:1200},{firstName:"Thomas",lastname:"J",rating:1250},{firstName:"Catherine",lastname:"K",rating:1300},{firstName:"Clare",lastname:"L",rating:1350},{firstName:"Judas",lastname:"M",rating:1400},{firstName:"Matthias",lastname:"N",rating:1450},{firstName:"Paul",lastname:"O",rating:1500},{firstName:"Mary",lastname:"P",rating:1600},{firstName:"Theresa",lastname:"Q",rating:1650},{firstName:"Megan",lastname:"R",rating:1700},{firstName:"Elizabeth",lastname:"S",rating:1750}];function k(e){var t=e.tourney,n=Object(r.useState)(t.roster.all),i=Object(o.a)(n,2),l=i[0],s=i[1],u=Object(r.useState)(!1),c=Object(o.a)(u,2),h=c[0],m=c[1],p={firstName:"",lastName:"",rating:1200},f=function(e){p[e.target.name]=e.target.value};return a.a.createElement("div",{className:"roster"},a.a.createElement("table",null,a.a.createElement("caption",null,"Roster"),a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"First name"),a.a.createElement("th",null,"Rating"))),a.a.createElement("tbody",null,l.map(function(e,t){return a.a.createElement("tr",{key:t},a.a.createElement("td",null,e.firstName),a.a.createElement("td",{className:"table__number"},e.rating))}))),a.a.createElement("p",null,a.a.createElement("button",{disabled:h,onClick:function(){var e=w.slice(0,16).map(function(e){return v(e)});t.addPlayers(e),m(!0),s([].concat(t.roster.all))}},"Load a demo roster")),a.a.createElement("p",null,"Or add your own players:"),a.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t.addPlayer(new v(p.firstName,p.lastName,p.rating)),s([].concat(t.roster.all))}},a.a.createElement("label",null,"First name",a.a.createElement("input",{type:"text",name:"firstName",onChange:f,required:!0})),a.a.createElement("label",null,"Last name",a.a.createElement("input",{type:"text",name:"lastName",onChange:f,required:!0})),a.a.createElement("label",null,"Rating",a.a.createElement("input",{type:"number",name:"rating",onChange:f,value:"1200"})),a.a.createElement("input",{type:"submit",value:"Add"})),a.a.createElement("p",{className:"center"},"Total rounds: ",t.numOfRounds()))}function C(e){var t=e.tourney,n=e.roundNum,i=t.roundList[n],l=Object(r.useState)(i.matches.map(function(e){return Object.assign({},e)})),s=Object(o.a)(l,2),u=s[0],c=s[1],h=function(e,t,n,r){var a=i.matches[n];r.target.checked?0===t?a.whiteWon():1===t?a.blackWon():.5===t&&a.draw():a.resetResult(),c(i.matches.map(function(e){return Object.assign({},e)}))};return a.a.createElement("div",null,a.a.createElement("table",{key:i.roundNum},a.a.createElement("caption",null,"Round ",i.roundNum+1," results"),a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"Won"),a.a.createElement("th",null,"Rating change"),a.a.createElement("th",null,"White"),a.a.createElement("th",null,"Draw"),a.a.createElement("th",null,"Black"),a.a.createElement("th",null,"Rating change"),a.a.createElement("th",null,"Won"))),a.a.createElement("tbody",null,u.map(function(e,t){return a.a.createElement("tr",{key:t},a.a.createElement("td",null,a.a.createElement("form",null,a.a.createElement("input",{type:"checkbox",checked:1===i.matches[t].result[0],onChange:function(e){return h(0,0,t,e)}}))),a.a.createElement("td",null,i.matches[t].newRating[0]-i.matches[t].origRating[0]),a.a.createElement("td",null,i.matches[t].whitePlayer.firstName),a.a.createElement("td",null,a.a.createElement("form",null,a.a.createElement("input",{type:"checkbox",checked:.5===i.matches[t].result[0],onChange:function(e){return h(0,.5,t,e)}}))),a.a.createElement("td",null,i.matches[t].blackPlayer.firstName),a.a.createElement("td",null,i.matches[t].newRating[1]-i.matches[t].origRating[1]),a.a.createElement("td",null,a.a.createElement("form",null,a.a.createElement("input",{type:"checkbox",checked:1===i.matches[t].result[1],onChange:function(e){return h(0,1,t,e)}}))))}))),a.a.createElement(S,{roundNum:i.roundNum,tourney:i.tourney}))}function S(e){var t=e.tourney,n=e.roundNum;return a.a.createElement("table",{key:n},a.a.createElement("caption",null,"Current Standings"),a.a.createElement("thead",null,a.a.createElement("tr",null,a.a.createElement("th",null,"First name"),a.a.createElement("th",null,"Score"),a.a.createElement("th",null,"Median"),a.a.createElement("th",null,"Solkoff"),a.a.createElement("th",null,"Cumulative"),a.a.createElement("th",null,"Cumulative of opposition"),a.a.createElement("th",null,"Rating"),a.a.createElement("th",null,"Color balance"),a.a.createElement("th",null,"Opponent count"))),a.a.createElement("tbody",null,t.playerStandings(n).map(function(e,r){return a.a.createElement("tr",{key:r},a.a.createElement("td",null,e.firstName),a.a.createElement("td",{className:"table__number"},t.playerScore(e,n)),a.a.createElement("td",{className:"table__number"},t.modifiedMedian(e,n)),a.a.createElement("td",{className:"table__number"},t.solkoff(e,n)),a.a.createElement("td",{className:"table__number"},t.playerScoreCum(e,n)),a.a.createElement("td",{className:"table__number"},t.playerOppScoreCum(e,n)),a.a.createElement("td",null,e.rating),a.a.createElement("td",{className:"table__number"},t.playerColorBalance(e,n)),a.a.createElement("td",{className:"table__number"},t.playerOppHistory(e,n).length))})))}var j=new N("CVL Winter Open",15);var L=function(){var e=Object(r.useState)([{name:"Roster",contents:a.a.createElement(k,{tourney:j})}]),t=Object(o.a)(e,2),n=t[0],i=t[1],l=Object(r.useState)(n[0]),s=Object(o.a)(l,2),u=s[0],c=s[1];return a.a.createElement("div",{className:"tournament"},a.a.createElement("nav",{className:"tabbar"},a.a.createElement("ul",null,n.map(function(e,t){return a.a.createElement("li",{key:t},a.a.createElement("button",{className:"tab",onClick:function(){return c(e)},disabled:u===e},e.name))}),a.a.createElement("li",null,a.a.createElement("button",{className:"tab new_round",onClick:function(e){var t=j.newRound();t?(n.push({name:"Round "+(t.roundNum+1),contents:a.a.createElement(C,{tourney:j,roundNum:t.roundNum})}),i([].concat(n)),c(n[n.length-1])):alert("Either add players or complete the current matches first.")}},"New Round")))),a.a.createElement("h1",null,"Chessahoochee: a chess tournament app"),u.contents)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(a.a.createElement(L,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},7:function(e,t,n){e.exports=n(20)}},[[7,1,2]]]);
//# sourceMappingURL=main.149eda27.chunk.js.map