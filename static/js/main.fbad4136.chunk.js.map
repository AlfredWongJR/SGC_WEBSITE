{"version":3,"sources":["jsx/utility.jsx.js","chess-tourney/match.js","chess-tourney/player.js","chess-tourney/scores.js","chess-tourney/pairing.js","chess-tourney/round.js","chess-tourney/tournament.js","chess-tourney/config.js","jsx/players.jsx.js","jsx/tourney-setup.jsx.js","jsx/round.jsx.js","jsx/tournament.jsx.js","jsx/options.jsx.js","App.jsx.js","serviceWorker.js","index.js"],"names":["MainNav","_ref","children","react_default","a","createElement","className","NavItem","_ref2","name","action","classNames","isOpen","role","tabIndex","onClick","onKeyPress","calcRatings","match","whiteElo","roster","getEloRank","blackElo","scoreExpected","getExpected","origRating","newRating","updateRating","result","map","rating","forEach","player","i","Object","freeze","round","importObj","black","white","tourney","ref_tourney","_importObj$roster","slicedToArray","players","getPlayerById","id","ref_round","warnings","ideal","reverse","blackWon","whiteWon","draw","setResult","resetResult","toConsumableArray","isComplete","isBye","p","dummy","includes","getColorInfo","color","getPlayerColor","indexOf","getPlayerInfo","getWhiteInfo","getBlackInfo","byeValue","isFrozen","matchCount","createPlayer","arguments","length","undefined","firstName","lastName","K","EloRank","hasHadBye","getPlayersByOpponent","dummyPlayer","toJSON","key","isReference","createPlayerManager","playerSource","lastId","inactive","getActive","filter","importPlayerById","fromRoster","playerId","push","importPlayerIdsList","playerIdList","importPlayer","importPlayerList","playerList","deactivatePlayer","activatePlayer","splice","removePlayer","canRemovePlayer","removePlayerById","getMatchesByPlayer","canRemovePlayerById","setByIdList","playerManager","list","currentIds","toAdd","toRemove","addPlayer","playerData","addPlayers","playersData","loadPlayerData","data","delPlayer","index","Number","playerScoreList","roundId","playerScore","score","scoreList","reduce","b","playerScoreCum","runningScore","cumScores","playerScoreListNoByes","totalScore","playerColorBalance","modifiedMedian","solkoff","scores","opponent","sort","pop","shift","finalScore","playerOppScoreCum","oppScores","calcStandings","tieBreaks","tieBreak","m","active","standingsFlat","standing","method","funcName","sortFunc","firstBy","thenBy","standingsTree","runningRank","sf","player1","player2","scoreTypes","getOwnPropertyNames","areEqual","areScoresEqual","avoidMeetingTwicePriority","sameScoresPriority","differentHalfPriority","differentDueColorPriority","maxPriority","byeMatch","potentialMatches","matches","reducedResults","dueColor","ref_prevRound","playerColor","colorBalance","opponentHistory","upperHalf","Array","from","Set","byePlayer","byeQueue","byePlayerData","pd","last","createMatch","playersWithScore","chunk","playerDatum","allMatches","ignore","src","playerMatches","scoreDiff","priority","Math","abs","ceil","concat","blossom","p1Id","p2Id","p1","p2","pair","matched","roundList","getMatchByPlayer","theMatch","hasBye","removeMatch","matchData","pairPlayers","cloneDeep","config","isNewRoundReady","times","getNumOfRounds","log2","newRound","createRound","removeRound","canRemoveRound","Error","r","addPlayerToByeQueue","removePlayerFromByeQueue","setByeQueue","byQueue","assign","roundData","moveTieBreak","methodId","newPos","movedMethod","noCircRefs","value","startsWith","JSONretriever","Players","_useState","useState","_useState2","setRoster","newPlayerDefault","_useState3","_useState4","newPlayer","setNewPlayer","updateField","event","update","target","dataset","rosterTable","data-id","onSubmit","preventDefault","type","onChange","required","TourneySetup","setPlayerList","isSelecting","setIsSelecting","PlayerSelect","TourneyManager","pImports","setPImports","useEffect","toggleCheck","globalRoster","react","checked","disabled","_ref3","_useState5","_useState6","byeList","byeDrop","byeSignUp","Options","_ref4","_useState7","_useState8","tbOptions","setTbOptions","tbToggle","pos","tbMove","dir","newTbOptions","data-pos","aria-label","RoundContainer","setRoundList","Round","NewRound","colSpan","RoundMatch","info","rawBalance","oppList","infoBox","setInfoBox","ratingDiff","setRatingDiff","PlayerInfo","style","textAlign","numeral","format","_ref5","TournamentList","tourneyList","setTourneyList","openTourney","setOpenTourney","newTourneyDefaults","newTourneyData","setNewTourneyData","selectTourney","content","Tournament","createTournament","keys","roundNums","setRoundNums","esm","roundNum","Standings","rank","j","JSON","stringify","outputPlayers","setOutputPlayers","outputTourney","setOutputTourney","tourneyData","parse","t","rows","cols","playerdata","demoData","slice","Boolean","window","location","hostname","ReactDOM","render","tourneylist","currentView","setCurrentView","setViewList","viewList","options_jsx_Options","document","getElementById","href","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.fbad4136.chunk.js","sourcesContent":["import React from \"react\";\n\nexport function MainNav({children}) {\n    return (\n        <nav className=\"main-nav\">\n            {children}\n        </nav>\n    );\n}\n\nexport function NavItem({name, action, isOpen}) {\n    let classNames = \"main-nav__item\";\n    if (isOpen) {\n        classNames += \" is-open\";\n    }\n    return (\n        <span className={classNames} role=\"menuitem\" tabIndex=\"0\"\n            onClick={action} onKeyPress={action}>\n            {name}\n        </span>\n    );\n}","/**\n * Update the ratings for a match based on their ratings when the match began\n * and the match result. See the `elo-rank` NPM package for more information.\n * @param {object} match The `match` object.\n * @returns {object} The `match` object.\n */\nfunction calcRatings(match) {\n    let whiteElo = match.roster[0].getEloRank();\n    let blackElo = match.roster[1].getEloRank();\n    const FLOOR = 100;\n    let scoreExpected = [\n        whiteElo.getExpected(match.origRating[0], match.origRating[1]),\n        blackElo.getExpected(match.origRating[1], match.origRating[0])\n    ];\n    match.newRating = [\n        whiteElo.updateRating(\n            scoreExpected[0],\n            match.result[0],\n            match.origRating[0]\n        ),\n        blackElo.updateRating(\n            scoreExpected[1],\n            match.result[1],\n            match.origRating[1]\n        )\n    ];\n    match.newRating = match.newRating.map(\n        (rating) => (\n            (rating < FLOOR)\n            ? FLOOR\n            : rating\n        )\n    );\n    match.roster.forEach(function (player, i) {\n        player.rating = match.newRating[i];\n    });\n    return match;\n}\n\n/**\n * Create an object representing a match in a tournament.\n * @param {object} round The round containing the match.\n * @param {object} black The `player` object for white.\n * @param {object} white The `player` object for black.\n */\nfunction createMatch(round, importObj) {\n    let black;\n    let white;\n    let tourney = round.ref_tourney;\n    if (importObj.roster) {\n        [white, black] = importObj.roster;\n    } else {\n        // if it's an array\n        white = importObj[0];\n        black = importObj[1];\n    }\n    // If the players are ID numbers, get their referant objects.\n    if (typeof black === \"number\") {\n        black = tourney.players.getPlayerById(black);\n    }\n    if (typeof white === \"number\") {\n        white = tourney.players.getPlayerById(white);\n    }\n    const match = {\n        id: importObj.id || 0,\n        /**\n         * @property {object} ref_round A reference to the round containing\n         * this match.\n         */\n        ref_round: round,\n        /**\n         * @property {object} ref_tourney A reference to the tournament\n         * containing this match.\n         */\n        ref_tourney: tourney,\n        /**\n         * @property {string} warnings Any warnings about the match, e.g. if\n         * there was a pairing error.\n         */\n        warnings: importObj.warnings || \"\",\n        /**\n         * @property {array} players The pair of `Player` objects. White is at\n         * index `0` and black is at index `1`.\n         */\n        roster: [white, black],\n        /**\n         * @property {array} result the scores for the match. A loss is `0`, a\n         * win is `1`, and a draw is `0.5`. White is at index `0` and black is\n         * at index `1`.\n         */\n        result: importObj.result || [0, 0],\n        /**\n         * @property {array} origRating the cached ratings from when the match\n         * began. White is at index `0` and black is at index `1`.\n         */\n        origRating: importObj.origRating || [white.rating, black.rating],\n        /**\n         * @property {array} newRating the updated ratings after the match ends.\n         * White is at index `0` and black is at index `1`.\n         */\n        newRating: importObj.newRating || [white.rating, black.rating],\n        /**\n         * @property {number} ideal How ideal this matchup was, based on the\n         * maximum matching algorithm.\n         */\n        ideal: importObj.ideal || 0,\n        /**\n         * Switch white and black.\n         * @returns {object} This `match` object.\n         */\n        reverse() {\n            match.roster.reverse();\n            match.result.reverse();\n            match.origRating.reverse();\n            match.newRating.reverse();\n            return match;\n        },\n        /**\n         * Set black as the winner and updates ratings.\n         * @returns {object} This `match` object.\n         */\n        blackWon() {\n            match.result = [0, 1];\n            calcRatings(match);\n            return match;\n        },\n        /**\n         * Set white as the winner and updates ratings.\n         * @returns {object} This `match` object.\n         */\n        whiteWon() {\n            match.result = [1, 0];\n            calcRatings(match);\n            return match;\n        },\n        /**\n         * Set the result as a draw and updates ratings.\n         * @returns {object} This `match` object.\n         */\n        draw() {\n            match.result = [0.5, 0.5];\n            calcRatings(match);\n            return match;\n        },\n        setResult(result) {\n            if (result !== match.result) {\n                match.result = result;\n                if (result[0] + result[1] === 0) {\n                    match.resetResult();\n                } else {\n                    calcRatings(match);\n                }\n            }\n            return match;\n        },\n        /**\n         * Resets the score and the rating updates.\n         * @returns {object} This `match` object.\n         */\n        resetResult() {\n            match.result = [0, 0];\n            match.newRating = [...match.origRating];\n            match.roster[0].rating = match.newRating[0];\n            match.roster[1].rating = match.newRating[1];\n            return match;\n        },\n        /**\n         * Get whether or not the match is over.\n         * @returns {bool} `True` if complete, `false` if incomplete.\n         */\n        isComplete() {\n            return match.result[0] + match.result[1] !== 0;\n        },\n        /**\n         * Get whether this is a bye match.\n         * @returns {bool} `True` if it's a bye match, `false` if not.\n         */\n        isBye() {\n            let dummies = match.roster.map((p) => p.dummy);\n            return dummies.includes(true);\n        },\n        /**\n         * Get all of the match data for a specific player color.\n         * @param {number} color `0` for white and `1` for black.\n         * @returns {object} A container for data: the `player` object,\n         * `result`, `origRating`, and `newRating`.\n         */\n        getColorInfo(color) {\n            return {\n                player: match.roster[color],\n                result: match.result[color],\n                origRating: match.origRating[color],\n                newRating: match.newRating[color]\n            };\n        },\n        /**\n         * Get the color ID of a player.\n         * @param {object} player A `player` object.\n         * @returns {number} `0` for white, `1` for black, and `-1` if the\n         * player isn't found in the match.\n         */\n        getPlayerColor(player) {\n            return match.roster.indexOf(player);\n        },\n        /**\n         * A shortcut for using `match.getPlayerColor()` and\n         * `match.getColorInfo()` together.\n         * @param {object} player A `player` object.\n         * @returns {object} See `matchGetPlayerColor()`.\n         */\n        getPlayerInfo(player) {\n            return match.getColorInfo(match.getPlayerColor(player));\n        },\n        /**\n         * A shortcut for `match.getColorInfo()` for white.\n         * @returns {object} See `match.getColorInfo()`\n         */\n        getWhiteInfo() {\n            return match.getColorInfo(0);\n        },\n        /**\n         * A shortcut for `match.getColorInfo()` for black.\n         * @returns {object} See `match.getColorInfo()`\n         */\n        getBlackInfo() {\n            return match.getColorInfo(1);\n        }\n    };\n    // match.roster = match.roster.map(function (player) {\n    //     if (typeof player === \"number\") {\n    //         if (player === -1) {\n    //             return dummyPlayer;\n    //         } else {\n    //             return tourney.players.getPlayerById(player);\n    //         }\n    //     } else {\n    //         return player;\n    //     }\n    // });\n    // set bye rounds\n    if (match.roster[0].dummy) {\n        match.result = [0, tourney.byeValue];\n    } else if (match.roster[1].dummy) {\n        match.result = [tourney.byeValue, 0];\n    }\n    match.roster.forEach(function (player) {\n        // This is stored statically so it's available even if data on past\n        // matches isn't. Be sure to safely decrement it when deleting match\n        // history.\n        if (!player.dummy && !Object.isFrozen(player)) {\n            player.matchCount += 1;\n        }\n    });\n    return match;\n}\n\nexport default Object.freeze(createMatch);\n","import EloRank from \"elo-rank\";\n\n/**\n * Represents an indivudal player. Call it with `createPlayer(\"John\", ...)` or\n * `createPlayer({firstName: \"John\", ...})`. The latter is convenient for\n * converting JSON objects.\n * @param {object} firstName Either the person's first name or an object\n * containing all the parameters.\n * @param {string} lastName  The person's last name.\n * @param {int}    rating    The person's Elo rating.\n */\nfunction createPlayer(importObj = {}) {\n    const player = {\n        /**\n         * @property {number} id The ID number of the player. Used mainly for\n         * JSON serialization.\n         */\n        id: importObj.id || 0,\n        /**\n         * @property {string} firstName The person's first name.\n         */\n        firstName: importObj.firstName || \"\",\n        /**\n         * @property {string} lastName The person's last name.\n         */\n        lastName: importObj.lastName || \"\",\n        /**\n         * @property {number} rating The person's Elo rating.\n         */\n        rating: importObj.rating || 0,\n        /**\n         * @property {bool} dummy If true, this player won't count in certain\n         * scorings.\n         */\n        dummy: importObj.dummy || false,\n        /**\n         * @property {number} matchCount Number of games the rating is based on.\n         */\n        matchCount: importObj.matchCount || 0,\n        /**\n         * Create an Elo calculator with an updated K-factor. See the `elo-rank`\n         * NPM package for more information.\n         * @param {object} tourney The current tournament.\n         * @returns {object} An `EloRank` object.\n         */\n        getEloRank() {\n            const ne = player.matchCount || 1;\n            const K = (800 / ne);\n            return new EloRank(K);\n        },\n        /**\n         * Get if a player has had a bye round.\n         * @param {object} tourney The current tournament.\n         * @returns {bool} True if the player has had a bye round, false if not.\n         * TODO: move this to the tournament object?\n         */\n        hasHadBye(tourney) {\n            return tourney.getPlayersByOpponent(player).includes(dummyPlayer);\n        },\n        toJSON(key) {\n            if (key && player.isReference) {\n                return player.id;\n            } else {\n                return player;\n            }\n        }\n    };\n    return player;\n}\n\n/**\n * A stand-in for bye matches.\n * @constant {object} dummyPlayer\n */\nconst dummyPlayer = Object.freeze(\n    createPlayer(\n        {\n            id: -1,\n            firstName: \"Bye\",\n            dummy: true,\n            rating: 0\n        }\n    )\n);\n\nfunction createPlayerManager(importObj = {}, playerSource = null) {\n    const roster = {\n        roster: [], // this gets added later\n        lastId: importObj.lastId || -1,\n        /**\n         * @property {object} ref_tourney A reference to the tournemnt\n         * containing this match.\n         */\n        ref_tourney: importObj.tourney || null,\n        /**\n         * @param {array} inactive A list of the players who won't be paired in\n         * future rounds.\n         */\n        inactive: [],\n        /**\n         * Get a list of players to be paired.\n         * @returns {array} A list of the active players.\n         */\n        getActive() {\n            return roster.roster.filter((i) => !roster.inactive.includes(i));\n        },\n        importPlayerById(fromRoster, playerId) {\n            let player = fromRoster.getPlayerById(playerId);\n            roster.roster.push(player);\n            return roster;\n        },\n        importPlayerIdsList(playerIdList) {\n            playerIdList.map((id) => roster.importPlayer(id));\n            return roster;\n        },\n        importPlayerList(playerList) {\n            roster.roster = playerList;\n            return roster;\n        },\n        /**\n         * Remove a player from the active roster. This player won't be placed\n         * in future rounds.\n         * @param {object} player The player object.\n         * @returns {object} This roster object.\n         */\n        deactivatePlayer(player) {\n            roster.inactive.push(player);\n            return roster;\n        },\n        /**\n         * Move an inactive player to the active roster to be placed in future\n         * rounds.\n         * @param {object} player The player object.\n         * @returns {object} This roster object.\n         */\n        activatePlayer(player) {\n            roster.inactive.splice(roster.inactive.indexOf(player), 1);\n            return roster;\n        },\n        /**\n         * Remove a player from the roster completely.\n         * @param {object} player The player object.\n         * @returns {object} This roster object.\n         */\n        removePlayer(player) {\n            if (roster.canRemovePlayer(player)) {\n                return null; // TODO: add a helpful error message\n            }\n            delete roster.roster[roster.roster.indexOf(player)];\n            return roster;\n        },\n        removePlayerById(playerId) {\n            roster.removePlayer(roster.getPlayerById(playerId));\n            return roster;\n        },\n        getPlayerById(id) {\n            if (id === -1) {\n                return dummyPlayer;\n            }\n            return roster.roster.filter((p) => p.id === id)[0];\n        },\n        canRemovePlayer(player) {\n            return (roster.ref_tourney.getMatchesByPlayer(player).length > 0);\n        },\n        canRemovePlayerById(id) {\n            return roster.canRemovePlayer(roster.getPlayerById(id));\n        },\n        setByIdList(playerManager, list) {\n            const currentIds = roster.roster.map((p) => p.id);\n            const toAdd = list.filter((id) => !currentIds.includes(id));\n            const toRemove = currentIds.filter((id) => !list.includes(id));\n            toAdd.forEach((id) => roster.importPlayerById(playerManager, id));\n            toRemove.forEach((id) => roster.removePlayerById(id));\n        },\n        /**\n         * Add a player to the roster.\n         * @param {object} player The player object to add.\n         * @returns {object} This created player object.\n         */\n        addPlayer(playerData) {\n            playerData.id = roster.lastId + 1;\n            roster.lastId = playerData.id;\n            let player = createPlayer(playerData);\n            roster.roster.push(player);\n            return player;\n        },\n        /**\n         * Add a list of players to the roster.\n         * @param {array} players A list of players to add.\n         * @returns {array} The list of created player objects.\n         */\n        addPlayers(playersData) {\n            let newPlayerList = playersData.map(\n                (player) => roster.addPlayer(player)\n            );\n            return newPlayerList;\n        },\n        loadPlayerData(data) {\n            roster.roster = data.map(\n                (player) => createPlayer(player)\n            );\n        },\n        delPlayer(playerId) {\n            let index = roster.roster.map(\n                (p) => p.id\n            ).indexOf(\n                Number(playerId)\n            );\n            if (index === -1) {\n                return null;\n            }\n            let player = roster.roster.splice(index, 1);\n            return player;\n        }\n    };\n    if (importObj.roster) {\n        importObj.roster.forEach(function (player) {\n            if (typeof player === \"number\") {\n                roster.importPlayerById(playerSource, player);\n            } else {\n                roster.addPlayer(player);\n            }\n        });\n    }\n    return roster;\n}\n\nexport {dummyPlayer, createPlayer, createPlayerManager};","import {firstBy} from \"thenby\";\n/**\n * Get a list of all of a player's scores from each match.\n * @param {Player} player\n * @returns {array} the list of scores\n */\nfunction playerScoreList(tourney, player, roundId = null) {\n    return tourney.getMatchesByPlayer(player, roundId).map(\n        (match) => match.result[match.roster.indexOf(player)]\n    );\n}\n\n// Maybe merge this with the other function?\nfunction playerScoreListNoByes(tourney, player, roundId = null) {\n    return tourney.getMatchesByPlayer(\n        player,\n        roundId\n    ).filter(\n        (match) => !match.isBye()\n    ).map(\n        (match) => match.result[match.roster.indexOf(player)]\n    );\n}\n\n/**\n * Get the total score of a player after a given round.\n * @param {Player} player\n * @param {number} roundId\n */\nfunction playerScore(tourney, player, roundId = null) {\n    var score = 0;\n    var scoreList = playerScoreList(tourney, player, roundId);\n    if (scoreList.length > 0) {\n        score = scoreList.reduce((a, b) => a + b);\n    }\n    return score;\n}\n\n/**\n * Get the cumulative score of a player\n * @param {Player} player\n * @param {number} roundId\n */\nfunction playerScoreCum(tourney, player, roundId = null) {\n    var runningScore = 0;\n    var cumScores = [];\n    var scores = playerScoreListNoByes(tourney, player, roundId);\n    scores.forEach(function (score) {\n        runningScore += score;\n        cumScores.push(runningScore);\n    });\n    var totalScore = 0;\n    if (cumScores.length !== 0) {\n        totalScore = cumScores.reduce((a, b) => a + b);\n    }\n    return totalScore;\n}\n\n/**\n * Calculate a player's color balance\n * @param {Player} player\n * @param {Int}    round The ID of the highest round to consider\n * @returns {Int} A negative number means they played as white more. A positive\n * number means they played as black more.\n */\nfunction playerColorBalance(tourney, player, roundId = null) {\n    var color = 0;\n    tourney.getMatchesByPlayer(player, roundId).filter(\n        (match) => !match.isBye()\n    ).forEach(\n        function (match) {\n            if (match.roster[0] === player) {\n                color += -1;\n            } else if (match.roster[1] === player) {\n                color += 1;\n            }\n        }\n    );\n    return color;\n}\n\n/**\n * Gets the modified median factor defined in USCF § 34E1\n * @param {Player} player\n * @param {number} roundId\n */\nfunction modifiedMedian(tourney, player, roundId = null, solkoff = false) {\n    // get all of the opponent's scores\n    var scores = tourney.getPlayersByOpponent(\n        player,\n        roundId\n    ).filter(\n        (opponent) => !opponent.dummy\n    ).map(\n        (opponent) => playerScore(tourney, opponent, roundId)\n    );\n    //sort them, then remove the first and last items\n    scores.sort();\n    if (!solkoff) {\n        scores.pop();\n        scores.shift();\n    }\n    var finalScore = 0;\n    if (scores.length > 0) {\n        finalScore = scores.reduce((a, b) => a + b);\n    }\n    return finalScore;\n}\n\n/**\n * A shortcut for passing the `solkoff` variable to `modifiedMedian`.\n * @param {Player} player\n * @param {number} roundId\n */\nfunction solkoff(tourney, player, roundId = null) {\n    return modifiedMedian(tourney, player, roundId, true);\n}\n\nfunction playerOppScoreCum(tourney, player, roundId = null) {\n    const opponents = tourney.getPlayersByOpponent(\n        player,\n        roundId\n    ).filter(\n        (opponent) => !opponent.dummy\n    );\n    var oppScores = opponents.map((p) => playerScoreCum(tourney, p, roundId));\n    var score = 0;\n    if (oppScores.length !== 0) {\n        score = oppScores.reduce((a, b) => a + b);\n    }\n    return score;\n}\n\nfunction areScoresEqual(player1, player2) {\n    const scoreTypes = Object.getOwnPropertyNames(player1);\n    var areEqual = true;\n    scoreTypes.forEach(function (score) {\n        if (score !== \"player\" && player1[score] !== player2[score]) {\n            areEqual = false;\n        }\n    });\n    return areEqual;\n}\n\nfunction getTbFunc(funcName) {\n    const tieBreakMethods = {\n        modifiedMedian,\n        playerColorBalance,\n        playerOppScoreCum,\n        playerScoreCum,\n        solkoff\n    };\n    return tieBreakMethods[funcName];\n}\n\n/**\n * Sort the standings by score, see USCF tie-break rules from § 34.\n * @param {number} roundId\n * @returns {Array} The sorted list of players\n */\nfunction calcStandings(tourney, roundId = null) {\n    const tieBreaks = tourney.tieBreak.filter((m) => m.active);\n    const standingsFlat = tourney.players.roster.map(function (player) {\n        var standing = {\n            player: player,\n            score: playerScore(tourney, player, roundId)\n        };\n        tieBreaks.forEach(function (method) {\n            standing[method.name] = getTbFunc(\n                method.funcName\n            )(tourney, player, roundId);\n        });\n        return standing;\n    });\n    var sortFunc = firstBy((player) => player.score, -1);\n    tieBreaks.forEach(function (method) {\n        sortFunc = sortFunc.thenBy((player) => player[method.funcName], -1);\n    });\n    standingsFlat.sort(sortFunc);\n    const standingsTree = [];\n    var runningRank = 0;\n    standingsFlat.forEach(function (player, i, sf) {\n        if (i !== 0) { // we can't compare the first player with a previous one\n            const prevPlayer = sf[i - 1];\n            if (!areScoresEqual(player, prevPlayer)) {\n                runningRank += 1;\n            }\n        }\n        if (!standingsTree[runningRank]) {\n            standingsTree[runningRank] = [];\n        }\n        standingsTree[runningRank].push(player);\n    });\n    return standingsTree;\n}\n\nexport default Object.freeze({\n    calcStandings,\n    modifiedMedian,\n    playerColorBalance,\n    playerOppScoreCum,\n    playerScore,\n    playerScoreCum,\n    playerScoreList,\n    solkoff\n});","import {firstBy} from \"thenby\";\nimport {chunk, last} from \"lodash\";\nimport blossom from \"edmonds-blossom\";\nimport createMatch from \"./match\";\nimport scores from \"./scores\";\nimport {dummyPlayer} from \"./player\";\n\n/**\n * TODO: These probably need to be tweaked a lot.\n */\n/**\n * @constant avoidMeetingTwicePriority The weight given to avoid players\n * meeting twice. This is the highest priority. (USCF § 27A1)\n */\nconst avoidMeetingTwicePriority = 20;\n/**\n * @constant sameScoresPriority The weight given to match players with\n * equal scores. This gets muliplied against a ratio taken from the distance\n * between each player's score. For example, if the tournament has players\n * scoring 0, 1, 2, and 3, and if a player scoring 1 gets compared with a\n * player scoring 3, then their `sameScoresPriority` will be reduced by 50%.\n * (`(3 - 1) / 4 = 0.5`) (USCF § 27A2)\n */\nconst sameScoresPriority = 16;\n/**\n * @constant differentHalfPriority The weight given to match players in lower\n * versus upper halves. This is only applied to players being matched within\n * the same score group. (USCF § 27A3)\n */\nconst differentHalfPriority = 2;\n/**\n * @constant differentDueColorPriority The weight given to match players with\n * opposite due colors. (USCF § 27A4 and § 27A5)\n */\nconst differentDueColorPriority = 1;\n\nconst maxPriority = (\n    avoidMeetingTwicePriority\n    + sameScoresPriority\n    + differentHalfPriority\n    + differentDueColorPriority\n);\n\n/**\n * Creates pairings according to the rules specified in USCF § 27, § 28,\n * and § 29. This is a work in progress and does not account for all of the\n * rules yet.\n * @param {object} round The round object.\n * @returns {array} The list of matches.\n */\nfunction pairPlayers(round) {\n    let byeMatch;\n    let potentialMatches;\n    let matches;\n    let results;\n    let reducedResults;\n    const tourney = round.ref_tourney;\n    const dueColor = function (player) {\n        if (!round.ref_prevRound) {\n            return null;\n        }\n        let color = 0;\n        let prevColor = round.ref_prevRound.playerColor(player);\n        if (prevColor === 0) {\n            color = 1;\n        }\n        return color;\n    };\n    let playerData = round.roster.map(function (player, id) {\n        return {\n            player: player,\n            id: id,\n            score: scores.playerScore(tourney, player, round.id),\n            dueColor: dueColor(player),\n            colorBalance: scores.playerColorBalance(tourney, player),\n            opponentHistory: tourney.getPlayersByOpponent(player),\n            upperHalf: false\n        };\n    });\n    const scoreList = Array.from(new Set(playerData.map((p) => p.score)));\n    scoreList.sort();\n    // Sort the data so matchups default to order by score and rating.\n    playerData.sort(\n        firstBy((p) => p.score, -1).thenBy((p) => p.player.rating, -1)\n    );\n    /**\n     * Create an array of blossom-compatible weighted matchups. This returns\n     * an array of each potential match, formatted like so: [idOfPlayer1,\n     * idOfPlayer2, priority]. A higher priority means a more likely matchup.\n     * Use it in `Array.prototype.reduce()`.\n     * @param {array} allMatches The running list of all possible matchups.\n     * @param {object} player1 The data for the first player.\n     * @param {number} ignore The index of the player.\n     * @param {array} src The original array.\n     */\n    const matchupReducer = function (allMatches, player1, ignore, src) {\n        let opponents = src.filter((p) => p !== player1);\n        let playerMatches = opponents.map(function (player2) {\n            let priority = 0;\n            let scoreDiff;\n            if (!player1.opponentHistory.includes(player2.player)) {\n                priority += avoidMeetingTwicePriority;\n            }\n            // Calculate the \"distance\" between their scores and multiply that\n            // against the `sameScoresPriority` constant.\n            scoreDiff = Math.abs(\n                scoreList.indexOf(player1.score)\n                - scoreList.indexOf(player2.score)\n            );\n            scoreDiff = (scoreList.length - scoreDiff) / scoreList.length;\n            priority += sameScoresPriority * scoreDiff;\n            // Only include `differentHalfPriority` if they're in the same\n            // score group.\n            if (player1.score === player2.score) {\n                if (player1.upperHalf !== player2.upperHalf) {\n                    priority += differentHalfPriority;\n                }\n            }\n            if (player1.dueColor === null) {\n                priority += differentDueColorPriority;\n            } else if (player1.dueColor !== player2.dueColor) {\n                priority += differentDueColorPriority;\n            }\n            return [player1.id, player2.id, Math.ceil(priority)];\n        });\n        allMatches = allMatches.concat(playerMatches);\n        return allMatches;\n    };\n\n    // If there's an odd number of players, time to assign a bye.\n    if (playerData.length % 2 !== 0) {\n        // Get the next person in line from bye signups.\n        let byePlayer = tourney.byeQueue.filter(\n            (p) => !p.hasHadBye(tourney)\n        )[0];\n        let byePlayerData = playerData.filter(\n            (pd) => pd.player === byePlayer\n        )[0];\n        // If there isn't anyone on the list, assign a bye to the lowest-rated\n        // player in the lowest score group. (USCF § 29L2.)\n        if (!byePlayerData) {\n            byePlayerData = last(\n                playerData.filter(\n                    (p) => !p.player.hasHadBye(tourney)\n                )\n            );\n        }\n        // In the impossible situation that *everyone* has played a bye round\n        // previously, then just pick the last player.\n        if (!byePlayerData) {\n            byePlayerData = last(playerData);\n        }\n        byeMatch = createMatch(round, [byePlayerData.player, dummyPlayer]);\n        // Remove the bye'd player from the list so they won't be matched again.\n        playerData = playerData.filter((p) => p !== byePlayerData);\n    }\n    // Determine which players are in the upper and lower halves of their score\n    // groups.\n    scoreList.forEach(function (score) {\n        let playersWithScore = playerData.filter((pd) => pd.score === score);\n        playersWithScore.sort((pd) => pd.player.rating).reverse();\n        if (playersWithScore.length > 1) {\n            // The first chunk is the upper half\n            chunk(\n                playersWithScore,\n                playersWithScore.length / 2\n            )[0].forEach(function (playerDatum) {\n                playerDatum.upperHalf = true;\n            });\n        }\n    });\n    // Run the reducer. See `matchupReducer()` for info.\n    potentialMatches = playerData.reduce(matchupReducer, []);\n    // Feed all of the potential matches to Edmonds-blossom and let the\n    // algorithm work its magic. This returns an array where each index is the\n    // ID of one player and each value is the ID of the matched player.\n    results = blossom(potentialMatches);\n    // Translate those IDs into actual pairs of players.\n    reducedResults = results.reduce(\n        function (matches, p1Id, p2Id) {\n            // Filter out unmatched players. (Even though we removed the byes\n            // from the list, blossom will automatically include their missing\n            // IDs in its results.)\n            if (p1Id !== -1) {\n                let p1 = playerData.filter((p) => p.id === p1Id)[0];\n                let p2 = playerData.filter((p) => p.id === p2Id)[0];\n                let ideal = potentialMatches.filter(\n                    (pair) => pair[0] === p1Id && pair[1] === p2Id\n                )[0][2];\n                let matched = matches.map((pair) => pair[0]);\n                // let matched = matches.map((pair) => pair[0]);\n                // Blossom returns a lot of redundant matches. Check that this\n                // matchup wasn't already added.\n                if (!matched.includes(p1) && !matched.includes(p2)) {\n                    matches.push([p1, p2, ideal]);\n                }\n            }\n            return matches;\n        },\n        []\n    );\n    // Sort by net score and rating for board placement.\n    reducedResults.sort(\n        firstBy(\n            (pair) => pair[0].score + pair[1].score,\n            -1\n        ).thenBy(\n            (pair) => pair[0].rating + pair[1].rating,\n            -1\n        )\n    );\n    // Turn the results into new match objects.\n    matches = reducedResults.map(\n        function (pair) {\n            const player1 = pair[0];\n            const player2 = pair[1];\n            const ideal = pair[2];\n            const match = createMatch(round, [player1.player, player2.player]);\n            match.ideal = ideal / maxPriority;\n            // A quick-and-easy way to keep colors mostly equal.\n            if (player1.colorBalance > player2.colorBalance) {\n                match.reverse();\n            }\n            // When the match isn't ideal, include a warning.\n            if (player1.opponentHistory.includes(player2.player)) {\n                match.warnings += (\n                    \" \" + player1.player.firstName\n                    + \" and \" + player2.player.firstName\n                    + \" have played previously.\"\n                );\n            }\n            [player1, player2].forEach(function (player) {\n                if (Math.abs(player.colorBalance) > 2) {\n                    match.warnings += (\n                        \" \" + player.player.firstName\n                        + \"'s color balance is off\"\n                    );\n                }\n            });\n            return match;\n        }\n    );\n    // The bye match always gets added last so as not to affect the numbering.\n    if (byeMatch) {\n        matches.push(byeMatch);\n    }\n    return matches;\n}\n\nexport default Object.freeze(pairPlayers);","import {dummyPlayer} from \"./player\";\nimport {last} from \"lodash\";\nimport pairPlayers from \"./pairing\";\nimport createMatch from \"./match\";\n\n/**\n * Create an object to represent a round in a tournament.\n * @param {object} tourney The tournament containing the round.\n */\nfunction createRound(tourney, importObj = {}) {\n    const round = {\n        /**\n         * @property {number} id The ID number of the round.\n         */\n        id: (\n            (importObj.id !== undefined)\n            ? importObj.id\n            : tourney.roundList.length\n        ),\n        /**\n         * @property {object} ref_tourney A reference to the tournament\n         * containing this round.\n         */\n        ref_tourney: tourney,\n        /**\n         * @property {array} roster The list of players in this round.\n         */\n        roster: importObj.roster || tourney.players.getActive(),\n        /**\n         * @property {object} prevRound The round previous to this one.\n         */\n        ref_prevRound: importObj.ref_prevRound || last(tourney.roundList),\n        /**\n         * @property {array} matches The list of match objects.\n         */\n        matches: importObj.matches || null,\n        /**\n         * Get whether or not all of the matches in this round have completed.\n         * @returns {bool} `True` if they have all completed, `false` if they\n         * haven't.\n         */\n        isComplete() {\n            return !round.matches.map((m) => m.isComplete()).includes(false);\n        },\n        /**\n         * Get the match player has played in.\n         * @param {object} player The player.\n         * @returns {?object} The match object or `null` if no match is\n         * found.\n         */\n        getMatchByPlayer(player) {\n            let theMatch = null;\n            round.matches.forEach(function (match) {\n                if (match.roster.includes(player)) {\n                    theMatch = match;\n                }\n            });\n            return theMatch;\n        },\n        /**\n         * Get the color of a player for this round.\n         * @param {object} player The player.\n         * @returns {number} `0` for white, `1` for black, or `-1` if the player\n         * wasn't found.\n         */\n        playerColor(player) {\n            let color = -1;\n            const match = round.getMatchByPlayer(player);\n            if (match) {\n                color = match.getPlayerColor(player);\n            }\n            return color;\n        },\n        /**\n         * Add a player to the round.\n         * TODO: I don't think this is used.\n         * @param {object} player The player.\n         * @returns {object} this round.\n         */\n        addPlayer(player) {\n            round.players.push(player);\n            return round;\n        },\n        /**\n         * Get whether or not this round has a bye round.\n         * TODO: I don't thin this is used.\n         * @returns {bool} `True` if it does, `false` if it doesn't.\n         */\n        hasBye() {\n            return round.roster.includes(dummyPlayer);\n        },\n        /**\n         * Remove a match. This undoes the results of the match.\n         * @param {number|object} match The object or ID of the match.\n         * @returns {object} This round object.\n         */\n        removeMatch(match) {\n            if (typeof match === \"number\") {\n                match = round.matches[match];\n            }\n            match.resetResult();\n            match.roster.forEach(function (player) {\n                player.matchCount -= 1;\n            });\n            round.matches = round.matches.filter((m) => m !== match);\n            return round;\n        },\n        toJSON(key) {\n            if (key === \"prevRound\") {\n                return round.id;\n            } else {\n                return round;\n            }\n        }\n    };\n    round.roster = round.roster.map(function (player) {\n        if (typeof player === \"number\") {\n            return tourney.players.getPlayerById(player);\n        } else {\n            return player;\n        }\n    });\n    if (round.matches) {\n        // If match data was imported, then init it.\n        round.matches = round.matches.map(\n            (matchData) => createMatch(round, matchData)\n        );\n    } else {\n        round.matches = pairPlayers(round);\n    }\n    round.matches.forEach(function (match, index) {\n        match.id = index;\n    });\n    return round;\n}\n\nexport default Object.freeze(createRound);","import createRound from \"./round\";\nimport {createPlayerManager} from \"./player\";\nimport {last, times, cloneDeep} from \"lodash\";\nimport config from \"./default-config.json\";\n\nfunction createTournament(importObj = \"\", playerSource = null) {\n    let name;\n    if (typeof importObj === \"string\") {\n        name = importObj;\n    } else {\n        name = importObj.name;\n    }\n    const tourney = {\n        id: 0,\n        /**\n         * @property {string} name The display name of the tournament.\n         */\n        name: name,\n        /**\n         * @property {array} roundList The list of rounds.\n         */\n        roundList: [],\n        /**\n         * @property {number} byeValue How many points a bye is worth. USCF\n         * suggests either 1 or 0.5.\n         */\n        byeValue: 1,\n        /**\n         * @property {array} byeQueue A list of players signed up for bye\n         * rounds, if byes are necessary.\n         */\n        byeQueue: [],\n        /**\n         * @property {object} roster The roster object.\n         */\n        players: importObj.players || null,\n        tieBreak: cloneDeep(config.tieBreak),\n        /**\n         * Get if a new round is ready or not.\n         * @returns {bool} `True` if a round is ready, `false` if not.\n         */\n        isNewRoundReady() {\n            let isReady = false;\n            if (tourney.roundList.length > 0) {\n                isReady = last(tourney.roundList).isComplete();\n            } else {\n                isReady = (tourney.players.roster.length > 0);\n            }\n            return isReady;\n        },\n        /**\n         * Get a list of matches containing a particular player.\n         * @param {object} player The specified player.\n         * @param {number} roundId The round to fetch up to.\n         * @returns {array} The list of matches.\n         */\n        getMatchesByPlayer(player, roundId = null) {\n            if (roundId === null) {\n                roundId = tourney.roundList.length;\n            }\n            let matches = [];\n            times(roundId + 1, function (i) {\n                if (tourney.roundList[i] !== undefined) {\n                    tourney.roundList[i].matches.forEach(function (match) {\n                        if (match.roster.indexOf(player) !== -1) {\n                            matches.push(match);\n                        }\n                    });\n                }\n            });\n            return matches;\n        },\n        /**\n         * Get a list of players who have played a specified player.\n         * @param {object} player The specified player.\n         * @param {number} roundId The round to fetch up to.\n         * @returns {array} A list of player objects.\n         */\n        getPlayersByOpponent(opponent, roundId = null) {\n            let players = [];\n            tourney.getMatchesByPlayer(opponent, roundId).forEach(\n                function (match) {\n                    players = players.concat(\n                        match.roster.filter(\n                            (player) => player !== opponent\n                        )\n                    );\n                }\n            );\n            return players;\n        },\n        /**\n         * Get the minimum number of rounds based on the number of players.\n         * @returns {number} The number of rounds.\n         */\n        getNumOfRounds() {\n            let roundId = Math.ceil(\n                Math.log2(tourney.players.getActive().length)\n            );\n            if (roundId === -Infinity) {\n                roundId = 0;\n            }\n            return roundId;\n        },\n        /**\n         * Create a new round and add it to the round list.\n         * @returns {object} The new round object.\n         */\n        newRound() {\n            if (!tourney.isNewRoundReady()) {\n                return false;\n            }\n            let newRound = createRound(tourney);\n            tourney.roundList.push(newRound);\n            return newRound;\n        },\n        removeRound(round) {\n            if (typeof round === \"number\" || typeof round === \"string\") {\n                round = tourney.roundList[round];\n            }\n            if (tourney.canRemoveRound(round)) {\n                throw new Error(\"You can only remove the last round\");\n            }\n            round.matches.forEach(function (match) {\n                round.removeMatch(match);\n            });\n            tourney.roundList = tourney.roundList.filter((r) => r !== round);\n            return tourney;\n        },\n        canRemoveRound(round) {\n            return round !== last(tourney.roundList);\n        },\n        /**\n         * Add a player to the bye queue.\n         * @param {object} player The player object.\n         * @returns {object} This tournament object.\n         */\n        addPlayerToByeQueue(player) {\n            tourney.byeQueue.push(player);\n            return tourney;\n        },\n        /**\n         * Remove a player from the bye queue.\n         * @param {object} player The player object.\n         * @returns {object} This tournament object.\n         */\n        removePlayerFromByeQueue(player) {\n            tourney.byeQueue = tourney.byeQueue.filter((p) => p !== player);\n            return tourney;\n        },\n        setByeQueue(playerList) {\n            tourney.byQueue = playerList;\n            return tourney;\n        }\n    };\n    // Importing JSON-parsed data\n    if (typeof importObj === \"object\") {\n        Object.assign(tourney, importObj);\n    }\n    if (tourney.players) {\n        // If roster data was imported, then init it.\n        tourney.players = createPlayerManager(tourney.players, playerSource);\n    } else {\n        // create a blank roster\n        tourney.players = createPlayerManager({}, playerSource);\n    }\n    tourney.players.ref_tourney = tourney;\n    if (tourney.roundList.length >= 0) {\n        // If round data was imported, then init it.\n        tourney.roundList = tourney.roundList.reduce(\n            function (roundList, roundData) {\n                roundData.ref_prevRound = last(roundList) || null;\n                roundList.push(createRound(tourney, roundData));\n                return roundList;\n            },\n            []\n        );\n    }\n    return tourney;\n}\n\nexport default Object.freeze(createTournament);\n","import config from \"./default-config.json\";\n\n/**\n * Moves a specific tie-break method to a new priority.\n * @function moveTieBreak\n * @param {number} methodId The key ID for the target tie-break method.\n * @param {number} newPos The new position to move the method do.\n * @returns {?array} The modified array of tie-break methods if successful, or\n * null on failure.\n */\nconfig.moveTieBreak = function (methodId, newPos) {\n    if (newPos < 0 || newPos > config.tieBreak.length - 1) {\n        return null;\n    }\n    if (!config.tieBreak[methodId]) {\n        return null;\n    }\n    let movedMethod = config.tieBreak.splice(methodId, 1)[0];\n    config.tieBreak.splice(newPos, 0, movedMethod);\n    return config.tieBreak;\n};\n\n/**\n * Removes circular references with `JSON.stringify()`.\n */\nconfig.noCircRefs = function (key, value) {\n    if (key.startsWith(\"ref_\")) {\n        return undefined;\n    } else {\n        return value;\n    }\n};\n\nconfig.JSONretriever = function (key, value) {\n    if (key.startsWith(\"ref_\")) {\n        return undefined;\n    } else if (key === \"roster\") {\n        return value.map((p) => p.id);\n    } else {\n        return value;\n    }\n};\n\n\nexport default Object.freeze(config);","import React, {useState} from \"react\";\n\nexport function Players({playerManager}) {\n    const [roster, setRoster] = useState(playerManager.roster);\n    const newPlayerDefault = {firstName: \"\", lastName: \"\", rating: 1200};\n    const [newPlayer, setNewPlayer] = useState(newPlayerDefault);\n    const handleSubmit = function (event) {\n        event.preventDefault();\n        playerManager.addPlayer(newPlayer);\n        setNewPlayer(newPlayerDefault);\n        setRoster([...playerManager.roster]);\n    };\n    const updateField = function (event) {\n        let update = {};\n        update[event.target.name] = event.target.value\n        setNewPlayer(Object.assign({}, newPlayer, update));\n    };\n    const delPlayer = function (event) {\n        playerManager.delPlayer(event.target.dataset.id);\n        setRoster([...playerManager.roster]);\n    };\n    let rosterTable = \"\";\n    if (roster.length > 0) {\n        rosterTable = \n        <table>\n            <caption>Demo Roster</caption>\n            <thead>\n                <tr>\n                <th>First name</th>\n                <th>Last name</th>\n                <th>Rating</th>\n                <th></th>\n                <th></th>\n                </tr>\n            </thead>\n            <tbody>\n                {roster.map((player) =>\n                <tr key={player.id} >\n                    <td className=\"table__player\">{player.firstName}</td>\n                    <td className=\"table__player\">{player.lastName}</td>\n                    <td className=\"table__number\">{player.rating}</td>\n                    <td>\n                        <button \n                            data-id={player.id}\n                            onClick={delPlayer}>\n                            x\n                        </button>\n                    </td>\n                    <td></td>\n                </tr>\n                )}\n            </tbody>\n        </table>\n    }\n    return (\n        <div className=\"roster\">\n            {rosterTable}\n            <p>\n                Add your own players:\n            </p>\n            <form onSubmit={handleSubmit}>\n                <p>\n                    <label>\n                        First name&nbsp;\n                        <input type=\"text\" name=\"firstName\" onChange={updateField}\n                            value={newPlayer.firstName} required />\n                    </label>\n                </p>\n                <p>\n                    <label>\n                        Last name&nbsp;\n                        <input type=\"text\" name=\"lastName\" onChange={updateField}\n                            value={newPlayer.lastName} required />\n                    </label>\n                </p>\n                <p>\n                    <label>\n                        Rating&nbsp;\n                        <input type=\"number\" name=\"rating\" onChange={updateField}\n                            value={newPlayer.rating} required />\n                    </label>\n                </p>\n                <p>\n                    <input type=\"submit\" value=\"Add\"/>\n                </p>\n            </form>\n        </div>\n    );\n}\n","import React, {useState, useEffect, Fragment} from \"react\";\n\nexport function TourneySetup({tourney, playerManager, playerList, setPlayerList}) {\n    const [isSelecting, setIsSelecting] = useState(playerList.length === 0);\n    if (isSelecting) {\n        return <PlayerSelect\n            key={tourney.id}\n            tourney={tourney} \n            playerManager={playerManager}\n            setIsSelecting={setIsSelecting}\n            setPlayerList={setPlayerList}\n            />\n    } else {\n        return <TourneyManager\n            key={tourney.id}\n            tourney={tourney}\n            setIsSelecting={setIsSelecting} />\n    }\n}\n\nfunction PlayerSelect({playerManager, tourney, setIsSelecting, setPlayerList}) {\n    const [pImports, setPImports] = useState(tourney.players.roster.map((p) => p.id));\n    useEffect(function () {\n        tourney.players.setByIdList(playerManager, pImports);\n        setPlayerList([...tourney.players.roster])\n    }, [pImports]);\n    const toggleCheck = function (event) {\n        const id = Number(event.target.dataset.id);\n        if (pImports.includes(id)) {\n            setPImports(pImports.filter((i) => i!== id));\n        } else {\n            setPImports([id].concat(pImports));\n        }\n    };\n    const globalRoster = playerManager.roster;\n    return (\n        <Fragment>\n            <p>\n                Select your players.\n            </p>\n            <ul>\n            {globalRoster.map((player) =>\n                <li key={player.id}>\n                    <input type=\"checkbox\" data-id={player.id}\n                        onChange={toggleCheck}\n                        checked={pImports.includes(player.id)}\n                        disabled={tourney.players.canRemovePlayerById(player.id)} />\n                    {player.firstName} {player.lastName}\n                </li>    \n            )}\n            </ul>\n            <button onClick={() => setPImports(globalRoster.map((p) => p.id))}>\n                Select all\n            </button>\n            <button onClick={() => setPImports([])}>\n                Select none\n            </button>\n            <button onClick={() => setIsSelecting(false)}>\n                Done\n            </button>\n        </Fragment>\n    );\n}\n\nexport function TourneyManager({tourney, setIsSelecting}) {\n    const [byeQueue, setByeQueue] = useState(tourney.byeQueue);\n    const byeSignUp = (player) => {\n        setByeQueue([...byeQueue,...[player]]);\n    };\n    const byeDrop = (player) => {\n        setByeQueue(byeQueue.filter((p) => p !== player));\n    };\n    useEffect(function () {\n        tourney.setByeQueue(byeQueue.map((id) => tourney.players.getPlayerById(id)));\n    }, [byeQueue]);\n    let byeList = \"\";\n    if (byeQueue.length > 0) {\n        byeList = (\n            <Fragment>\n                <h2>Bye signups:</h2>\n                <ol>\n                {byeQueue.map((player) =>  \n                    <li key={player.id}\n                        className={player.hasHadBye(tourney) ? \"inactive\" : \"active\"}>\n                        {player.firstName}\n                        <button\n                            onClick={() => byeDrop(player)}\n                            disabled={player.hasHadBye(tourney)}>\n                            x\n                        </button>\n                    </li>\n                )}\n                </ol>\n            </Fragment>\n        )\n    }\n    let rosterTable = (\n        <table>\n            <caption>Roster</caption>\n            <thead>\n                <tr>\n                <th>First name</th>\n                <th>Rating</th>\n                <th>Rounds played</th>\n                <th></th>\n                </tr>\n            </thead>\n            <tbody>\n                {tourney.players.roster.map((player) =>\n                <tr key={player.id} \n                    className={tourney.players.inactive.includes(player) ? \"inactive\" : \"active\"}>\n                    <td className=\"table__player\">{player.firstName}</td>\n                    <td className=\"table__number\">{player.rating}</td>\n                    <td className=\"table__number\">\n                    {tourney.getMatchesByPlayer(player).length}\n                    </td>\n                    <td>\n                    {(tourney.byeQueue.includes(player) || player.hasHadBye(tourney)\n                        ? <button disabled>Bye</button>\n                        : <button onClick={() => byeSignUp(player)}>Bye</button>)\n                    }\n                    </td>\n                </tr>\n                )}\n            </tbody>\n        </table>\n    );\n    return (\n        <Fragment>\n            {rosterTable}\n            {byeList}\n            <button onClick={() => setIsSelecting(true)}>\n                Select players\n            </button>\n            <button>\n                New round\n            </button>\n            <Options key={tourney.id} tourney={tourney} />\n        </Fragment>\n    );\n}\n\nfunction Options({tourney}) {\n    const [tbOptions, setTbOptions] = useState(tourney.tieBreak);\n    const tbToggle = (event) => {\n        let id = event.target.dataset.pos;\n        tbOptions[id].active = event.target.checked;\n        setTbOptions([...tbOptions]);\n    };\n    const tbMove = (pos, dir) => {\n        const newPos = pos + dir;\n        const newTbOptions = [...tbOptions];\n        const movedMethod = newTbOptions.splice(pos, 1)[0];\n        newTbOptions.splice(newPos, 0, movedMethod);\n        setTbOptions(newTbOptions);\n    };\n    useEffect(function () {\n        tourney.tieBreak = tbOptions\n    });\n    return (\n        <section>\n            <h3>Options</h3>\n            <h3>Tie break priority</h3>\n            <ol>\n            {tbOptions.map((method, i) => \n                <li key={method.funcName}>\n                    <input \n                        type=\"checkbox\"\n                        data-pos={i} \n                        checked={method.active} \n                        onChange={tbToggle}/>\n                    {method.name}\n                    <button onClick={() => tbMove(i, -1)} disabled={i === 0}>\n                        <span role=\"img\" aria-label=\"Move up\">↑</span>\n                    </button>\n                    <button onClick={() => tbMove(i, 1)}\n                        disabled={i === tbOptions.length - 1} >\n                        <span role=\"img\" aria-label=\"Move down\">↓</span>\n                    </button>\n                </li>\n            )}\n            </ol>\n        </section>\n    );\n}","import React, {useState, useEffect, Fragment} from \"react\";\nimport {scores} from \"../chess-tourney\";\nimport numeral from \"numeral\";\nimport \"../round.css\";\n\nexport function RoundContainer({tourney, round, roundList, setRoundList}) {\n    if (round) {\n        return <Round round={round} setRoundList={setRoundList} />\n    } else {\n        return <NewRound tourney={tourney} setRoundList={setRoundList} />\n    }\n}\n\nfunction NewRound({tourney, setRoundList}) {\n    const makeRound = function () {\n        tourney.newRound();\n        setRoundList([...tourney.roundList]);\n    };\n    if (tourney.isNewRoundReady()) {\n        return (\n            <button\n                onClick={makeRound}>\n                Make new round\n            </button>);\n    } else {\n        return <p>Complete the last round first.</p>\n    }\n}\n\nfunction Round({round, setRoundList}) {\n    const tourney = round.ref_tourney;\n    const [matches, setMatches] = useState(round.matches);\n    const delRound = function () {\n        tourney.removeRound(round);\n        setRoundList([...tourney.roundList]);\n    };\n    return (\n        <Fragment>\n            <table className=\"table__roster\">\n                <caption>Round {round.id + 1} results</caption>\n                <thead>\n                <tr>\n                    <th>#</th>\n                    <th colSpan=\"2\">White</th>\n                    <th>Draw</th>\n                    <th colSpan=\"2\">Black</th>\n                    <th></th>\n                </tr>\n                </thead>\n                <tbody>\n                {matches.map((match) =>\n                    <RoundMatch\n                        key={match.id} match={match} />\n                )}\n                </tbody>\n            </table>\n            <h2>Actions</h2>\n            <button\n                onClick={delRound}\n                disabled={tourney.canRemoveRound(round)}>\n                Delete round\n            </button>\n        </Fragment>\n    );\n}\n\nfunction RoundMatch({match}) {\n    // Getting info for the toggleable box\n    const round = match.ref_round;\n    const tourney = match.ref_tourney;\n    const white = match.getWhiteInfo();\n    const black = match.getBlackInfo();\n    [white, black].forEach(function (info) {\n        let rawBalance = scores.playerColorBalance(tourney, info.player, round.id);\n        let colorBalance = \"Even\";\n        if (rawBalance < 0) {\n            colorBalance = \"White +\" + Math.abs(rawBalance);\n        } else if (rawBalance > 0) {\n            colorBalance = \"Black +\" + rawBalance;\n        }\n        info.colorBalance = colorBalance;\n        info.score = scores.playerScore(tourney, info.player, round.id)\n        info.oppList = tourney.getPlayersByOpponent(info.player, round.id);\n    });\n    const [result, setResult] = useState(match.result);\n    const [infoBox, setInfoBox] = useState(false);\n    const [ratingDiff, setRatingDiff] = useState([\n        white.newRating - white.origRating,\n        black.newRating - black.origRating\n    ])\n    useEffect(function () {\n        match.setResult(result);\n        setRatingDiff([\n            match.getWhiteInfo().newRating - match.getWhiteInfo().origRating,\n            match.getBlackInfo().newRating - match.getBlackInfo().origRating\n        ])\n    }, [result]);\n    return (\n        <Fragment>\n            <tr className={match.isBye() ? \"inactive\" : \"\"}>\n                <td className=\"table__number\">{match.id + 1}</td>\n                <td className=\"table__player\">\n                    {white.player.firstName} {white.player.lastName}\n                </td>\n                <td className=\"table__input\">\n                    <input \n                    type=\"radio\"\n                    checked={result[0] === 1}\n                    disabled={match.isBye()}\n                    onChange={() => setResult([1,0])} />\n                </td>\n                <td className=\"table__input\">\n                    <input \n                        type=\"radio\"\n                        checked={result[0] === 0.5}\n                        disabled={match.isBye()}\n                        onChange={() => setResult([0.5, 0.5])} />\n                </td>\n                <td className=\"table__input\">\n                    <input \n                        type=\"radio\"\n                        checked={result[1] === 1}\n                        disabled={match.isBye()}\n                        onChange={() => setResult([0, 1])} />\n                </td>\n                <td className=\"table__player\">\n                    {black.player.firstName} {black.player.lastName}\n                </td>\n                <td>\n                    <button onClick={() => setInfoBox(!infoBox)}>\n                        ?\n                    </button>\n                    {match.warnings}\n                </td>\n            </tr>\n            {infoBox &&\n                <Fragment>\n                <tr>\n                    <td></td>\n                    <td colSpan=\"2\">\n                        <PlayerInfo player={white} ratingDiff={ratingDiff[0]}/>\n                    </td>\n                    <td></td>\n                    <td colSpan=\"2\">\n                        <PlayerInfo player={black} ratingDiff={ratingDiff[1]}/>\n                    </td>\n                    <td></td>\n                </tr>\n                <tr>\n                    <td colSpan=\"7\" style={{textAlign: \"center\"}}>\n                        Match ideal: {numeral(match.ideal).format(\"00%\")}\n                    </td>\n                </tr>\n            </Fragment>\n            }\n        </Fragment>\n    );\n}\n\nfunction PlayerInfo({player, ratingDiff}) {\n    return (\n        <dl className=\"player-card\">\n            <dt>Score</dt>\n            <dd>{player.score}</dd>\n            <dt>Rating</dt>\n            <dd>\n                {player.origRating}\n                &nbsp;({numeral(ratingDiff).format(\"+0\")})\n            </dd>\n            <dt>Color balance</dt>\n            <dd>{player.colorBalance}</dd>\n            <dt>Opponent history</dt>\n            <dd>\n                <ol>\n                {player.oppList.map((opponent, i) =>\n                    <li key={i}>\n                    {opponent.firstName}\n                    </li>  \n                )}\n                </ol>\n            </dd>\n        </dl>\n\n    );\n}","import React, {useState, useEffect, Fragment} from \"react\";\nimport { Tab, Tabs, TabList, TabPanel } from \"react-tabs\";\nimport \"react-tabs/style/react-tabs.css\";\nimport {createTournament, scores} from \"../chess-tourney\";\nimport {TourneySetup} from \"./tourney-setup.jsx\"\nimport {RoundContainer} from \"./round.jsx\";\n\nexport function TournamentList({playerManager, tourneyList, setTourneyList, openTourney, setOpenTourney}) {\n    const newTourneyDefaults = {name: \"The most epic tournament\"};\n    const [newTourneyData, setNewTourneyData] = useState(newTourneyDefaults);\n    const newTourney = function(event) {\n        event.preventDefault();\n        let tourney = createTournament(event.target.name.value);\n        tourney.id = tourneyList.length;\n        setTourneyList([...tourneyList,...[tourney]])\n        setNewTourneyData(newTourneyDefaults);\n        setOpenTourney(tourney)\n    };\n    const updateField = function (event) {\n        let update = {};\n        update[event.target.name] = event.target.value\n        setNewTourneyData(Object.assign({}, newTourneyData, update));\n    };\n    const selectTourney = function (event) {\n        const id = event.target.dataset.id;\n        setOpenTourney(tourneyList[id])\n    };\n    let content = \"\";\n    if (openTourney) {\n        content = \n        <Tournament \n        key={openTourney.id}\n        tourney={openTourney}\n        playerManager={playerManager}\n        setOpenTourney={setOpenTourney} />\n    } else {\n        content = \n        <Fragment>\n            {(tourneyList.length > 0)\n            ?\n                <ol>\n                    {tourneyList.map((tourney, i) => \n                        <li key={i} data-id={i}  tabIndex=\"0\" role=\"menuitem\"\n                            onClick={selectTourney} onKeyPress={selectTourney}>\n                            {tourney.name}\n                        </li>    \n                    )}\n                </ol>\n            :\n                <p>\n                    No tournaments added yet.\n                </p>\n            }\n            <form onSubmit={newTourney}>\n                <input type=\"text\" name=\"name\" value={newTourneyData.name}\n                    onChange={updateField} required />\n                <input type=\"submit\" value=\"New Tournament\" />\n            </form>\n        </Fragment>\n    }\n    return (\n        <main>\n            {content}\n        </main>\n    );\n}\n\nfunction Tournament({tourney, playerManager, setOpenTourney}) {\n    const [playerList, setPlayerList] = useState(tourney.players.roster);\n    const [roundNums, setRoundNums] = useState(\n        [...Array(tourney.getNumOfRounds()).keys()]\n    );\n    useEffect(function () {\n        setRoundNums([...Array(tourney.getNumOfRounds()).keys()]);\n    }, [playerList]);\n    const [roundList, setRoundList] = useState(tourney.roundList);\n    const isRoundReady = function (id) {\n        // we also return if it's the next available round so the user can begin it\n        return roundList[id] || id === roundList.length;\n    }\n    return (\n        <Tabs>\n            <button onClick={() => setOpenTourney(null)}>&lt; back</button>\n            <h2>{tourney.name}</h2>\n            <TabList>\n                <Tab>Setup</Tab>\n                <Tab disabled={playerList.length === 0}>Standings</Tab>\n                {roundNums.map((roundNum) => \n                    <Tab key={roundNum} disabled={!isRoundReady(roundNum)}>\n                        Round {roundNum + 1}\n                    </Tab>    \n                )}\n            </TabList>\n            <TabPanel>\n                <TourneySetup key={tourney.id} setPlayerList={setPlayerList}\n                    playerList={playerList}\n                    tourney={tourney} playerManager={playerManager}/>\n            </TabPanel>\n            <TabPanel>\n                <Standings tourney={tourney} />\n            </TabPanel>\n            {roundNums.map((roundNum) => \n                <TabPanel key={roundNum}>\n                    <RoundContainer key={roundNum} tourney={tourney}\n                        round={roundList[roundNum]} roundList={roundList}\n                        setRoundList={setRoundList} />\n                </TabPanel>\n            )}\n        </Tabs>\n    );\n}\n\nexport function Standings({tourney}) {\n    return (\n      <table>\n        <caption>Current Standings</caption>\n        <thead>\n          <tr>\n            <th></th>\n            <th>First name</th>\n            <th>Score</th>\n            {tourney.tieBreak.filter((m) => m.active).map((method, i) =>\n                <th key={i}>{method.name}</th>\n            )}\n          </tr>\n        </thead>\n        {scores.calcStandings(tourney).map((rank, i) => \n          <tbody key={i}>\n            {rank.map((player, j) => \n              <tr key={j}>\n                  <td>{i + 1}</td>\n                  <td>{player.player.firstName}</td>\n                  <td className=\"table__number\">{player.score}</td>\n                  {tourney.tieBreak.filter((m) => m.active).map((method, i) =>\n                      <td className=\"table__number\" key={i}>\n                          {player[method.name]}\n                      </td>\n                  )}\n              </tr>\n              )}\n          </tbody>\n        )}\n      </table>\n    );\n}\n","import React, {useState} from \"react\";\nimport {createTournament, config} from \"../chess-tourney\";\n\nexport function Options({playerManager, tourneyList, setTourneyList}) {\n    const [outputPlayers, setOutputPlayers] = useState(\n        JSON.stringify(playerManager.roster, config.JSONretriever, 2)\n    );\n    const [outputTourney, setOutputTourney] = useState(\n        JSON.stringify(tourneyList, config.JSONretriever, 2)\n    );\n    const loadPlayers = (event) => {\n        event.preventDefault();\n        let players = JSON.parse(event.target.playerdata.value);\n        playerManager.loadPlayerData(players);\n    };\n    const changedPlayers = (event) => {\n        setOutputPlayers(event.target.value);\n    };\n    const loadTourney = function (event) {\n        event.preventDefault();\n        let tourneyData = JSON.parse(event.target.tourneyData.value);\n        setTourneyList(tourneyData.map((t) => createTournament(t, playerManager)));\n    };\n    return (\n        <section>\n            <h2>Export tournament data</h2>\n            <form onSubmit={loadTourney}>\n                <textarea \n                    className=\"json\"\n                    rows=\"25\"\n                    cols=\"50\" \n                    value={outputTourney}\n                    onChange={(event) => setOutputTourney(event.target.value)}\n                    name=\"tourneyData\"\n                    />\n                <input type=\"submit\" value=\"load\" />\n            </form>\n            <h2>Export player data</h2>\n            <form onSubmit={loadPlayers}>\n                <textarea\n                    className=\"json\"\n                    rows=\"25\"\n                    cols=\"50\"\n                    value={outputPlayers}\n                    name=\"playerdata\"\n                    onChange={changedPlayers} />\n                <input type=\"submit\" value=\"Load\" />\n            </form>\n        </section>\n    );\n}","import React, { useState } from \"react\";\nimport \"./App.css\";\nimport {MainNav, NavItem} from \"./jsx/utility.jsx\"\nimport {createPlayerManager} from \"./chess-tourney\";\nimport {Players} from \"./jsx/players.jsx\";\nimport {TournamentList} from \"./jsx/tournament.jsx\";\nimport {Options} from \"./jsx/options.jsx\";\nimport demoRoster from \"./demo-players.json\";\n\n// const defaultTournament = createTournament(\"CVL Winter Open\");\nconst demoData = {roster: demoRoster.slice(0,16)}\n\nfunction App() {\n    const [tourneylist, setTourneyList] = useState([]);\n    const [openTourney, setOpenTourney] = useState(null);\n    // eslint-disable-next-line no-unused-vars\n    const [playerManager, setPlayerManager] = useState(\n        createPlayerManager(demoData)\n    );\n    const [currentView, setCurrentView] = useState(0);\n    const setViewList = (id) => setCurrentView(id);\n    const viewList = [\n        <Players playerManager={playerManager} />,\n        <TournamentList playerManager={playerManager}\n            tourneyList={tourneylist} setTourneyList={setTourneyList}\n            openTourney={openTourney} setOpenTourney={setOpenTourney} />,\n        <Options playerManager={playerManager} tourneyList={tourneylist}\n            setTourneyList={setTourneyList} />\n    ];\n    return (\n        <main>\n            <MainNav>\n                <NavItem name=\"Players\"\n                    action={() => setViewList(0)} isOpen={currentView === 0} />\n                <NavItem name=\"Tournaments\"\n                    action={() => setViewList(1)} isOpen={currentView === 1} />\n                <NavItem name=\"Options\"\n                    action={() => setViewList(2)} isOpen={currentView === 2} />\n            </MainNav>\n            {viewList[currentView]}\n        </main>\n    );\n    // return (\n    //     <div className=\"tournament\">\n    //     <nav className=\"tabbar\">\n    //         <ul>\n    //         {tabList.map((tab, i) => \n    //             <li key={i}>\n    //             <button\n    //                 className=\"tab\"\n    //                 onClick={() => setCurrentTab(tab)}\n    //                 disabled={currentTab === tab} >\n    //                 {tab.name}\n    //             </button>\n    //             </li>\n    //         )}\n    //         <li>\n    //             <button \n    //             className=\"tab new_round\"\n    //             onClick={newRound} >\n    //             New Round\n    //             </button>\n    //         </li>\n    //         </ul>\n    //     </nav>\n    //     <h1>Chessahoochee: a chess tournament app</h1>\n    //     {currentTab.contents}\n    //     </div>\n    // );\n}\n\nfunction Caution() {\n    return (\n        <p>\n            <span role=\"img\" aria-label=\"waving hand\">👋</span>&nbsp;\n            This is an unstable demo build!\n            Want to help make it better? Head to the&nbsp;\n            <span role=\"img\" aria-label=\"finger pointing right\">👉</span>&nbsp;\n            <a href=\"https://github.com/johnridesabike/chessahoochee\">Git repository</a>.\n        </p>\n    );\n}\n\nexport {App, Caution};\n","/*jslint browser*/\n/*global process fetch*/\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets;\n      // see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready.then((registration) => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport {App, Caution} from \"./App.jsx\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\nReactDOM.render(<Caution />, document.getElementById(\"caution\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}